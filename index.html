<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Florida Gated Communities Map</title>
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"/>
<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"/>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.css"/>
<style>
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'Segoe UI', sans-serif; background: #1a1a2e; color: #eee; height: 100vh; overflow: hidden; display: flex; flex-direction: column; }

/* ── Header ──────────────────────────────────────────────────────────────── */
#header {
  background: linear-gradient(135deg, #0f3460 0%, #16213e 100%);
  padding: 10px 18px 8px;
  display: flex; flex-direction: column; gap: 8px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.5); z-index: 1000;
}
#header-row1 { display: flex; align-items: center; gap: 18px; flex-wrap: wrap; }
#header-row2 { display: flex; align-items: center; gap: 14px; flex-wrap: wrap; border-top: 1px solid rgba(255,255,255,0.08); padding-top: 8px; }

#header h1 { font-size: 1.1rem; font-weight: 700; color: #e94560; white-space: nowrap; flex-shrink: 0; }
#header h1 span { color: #fff; }

.ctrl-group { display: flex; flex-direction: column; gap: 3px; }
.ctrl-label { font-size: 0.65rem; font-weight: 600; color: #718096; text-transform: uppercase; letter-spacing: 0.8px; }

.noUi-connect { background: #e94560; }
.noUi-handle { background: #fff; border: 2px solid #e94560; border-radius: 50%; box-shadow: 0 0 5px rgba(233,69,96,.5); cursor: pointer; }
.noUi-handle::before, .noUi-handle::after { display: none; }
.noUi-target { background: #2d3748; border: none; box-shadow: none; height: 5px; }

/* Filter chips */
.chip-row { display: flex; gap: 4px; flex-wrap: wrap; }
.chip {
  padding: 3px 8px; border-radius: 20px; border: 1.5px solid;
  font-size: 0.65rem; font-weight: 600; cursor: pointer; transition: all .18s; background: transparent;
  white-space: nowrap;
}
.elec-btn { border-color: #4a5568; color: #718096; }
.elec-btn.active { border-color: #e2e8f0; color: #1a1a2e; background: #e2e8f0; }

/* Search */
#search-wrap { display: flex; flex-direction: column; gap: 3px; flex: 1; min-width: 160px; max-width: 240px; }
#search-input {
  background: rgba(45,55,72,0.8); border: 1px solid #4a5568; border-radius: 6px;
  color: #eee; padding: 5px 10px; font-size: 0.78rem; outline: none;
  transition: border-color .2s;
}
#search-input:focus { border-color: #63b3ed; }
#search-input::placeholder { color: #718096; }

/* Count + favorites badges */
#badges { display: flex; gap: 8px; align-items: center; margin-left: auto; }
#count-badge { background: #e94560; color: #fff; border-radius: 20px; padding: 4px 11px; font-size: 0.75rem; font-weight: 700; white-space: nowrap; }
#fav-btn {
  background: rgba(246,173,85,0.15); color: #f6ad55; border: 1.5px solid #f6ad55;
  border-radius: 20px; padding: 4px 11px; font-size: 0.75rem; font-weight: 700;
  cursor: pointer; white-space: nowrap; transition: all .2s;
}
#fav-btn:hover { background: rgba(246,173,85,0.3); }
#fav-btn.has-favs { background: rgba(246,173,85,0.25); }

/* ── Map ──────────────────────────────────────────────────────────────────── */
#map { flex: 1; min-height: 0; position: relative; overflow: hidden; }

/* ── Popups ───────────────────────────────────────────────────────────────── */
.leaflet-popup-content-wrapper {
  background: #16213e; color: #eee; border-radius: 10px;
  box-shadow: 0 4px 20px rgba(0,0,0,.6); border: 1px solid #0f3460; max-width: 290px;
}
.leaflet-popup-tip { background: #16213e; }
.popup-name { font-size: .95rem; font-weight: 700; color: #e94560; margin-bottom: 2px; }
.popup-city { font-size: .73rem; color: #a0aec0; margin-bottom: 6px; }
.popup-type { display: inline-block; padding: 2px 7px; border-radius: 12px; font-size: .65rem; font-weight: 600; margin-bottom: 6px; }
.popup-price { font-size: .9rem; font-weight: 700; color: #68d391; margin-bottom: 5px; }
.popup-amenities { font-size: .71rem; color: #cbd5e0; line-height: 1.4; margin-bottom: 6px; }
.popup-meta { display: flex; gap: 12px; font-size: .68rem; color: #a0aec0; margin-bottom: 8px; }
.popup-meta span b { color: #eee; }
.popup-actions { display: flex; gap: 7px; flex-wrap: wrap; }
.popup-btn {
  padding: 4px 10px; border-radius: 6px; font-size: .68rem; font-weight: 600;
  cursor: pointer; border: 1px solid; transition: all .18s; text-decoration: none;
  display: inline-block;
}
.btn-website { background: rgba(99,179,237,.15); color: #63b3ed; border-color: #63b3ed; }
.btn-website:hover { background: rgba(99,179,237,.3); }
.btn-fav { background: rgba(246,173,85,.12); color: #f6ad55; border-color: #f6ad55; }
.btn-fav:hover { background: rgba(246,173,85,.28); }
.btn-fav.starred { background: rgba(246,173,85,.35); }

/* ── Side panel ───────────────────────────────────────────────────────────── */
#panel-toggle {
  position: absolute; right: 0; top: 50%; transform: translateY(-50%);
  z-index: 1001; background: rgba(15,52,96,0.97); border: 1px solid #4a5568;
  border-right: none; border-radius: 6px 0 0 6px;
  color: #eee; padding: 14px 7px; cursor: pointer; font-size: 1.1rem;
  transition: right .3s ease; line-height: 1;
}
#panel-toggle:hover { background: #0f3460; }
#side-panel {
  position: absolute; right: 0; top: 0; bottom: 0; z-index: 1000;
  width: 234px; background: rgba(13,40,80,0.97); backdrop-filter: blur(8px);
  border-left: 1px solid #2d3748; display: flex; flex-direction: column;
  overflow-y: auto; transform: translateX(100%); transition: transform .3s ease;
}
#side-panel.open { transform: translateX(0); }
.sp-head {
  display: flex; align-items: center; padding: 11px 14px 9px;
  background: #0f3460; border-bottom: 1px solid #2d3748; flex-shrink: 0;
}
.sp-heading { font-size: .82rem; font-weight: 700; color: #e2e8f0; flex: 1; letter-spacing: .3px; }
.sp-close { background: none; border: none; color: #718096; font-size: 1.2rem; cursor: pointer; padding: 0 2px; }
.sp-close:hover { color: #e94560; }
.sp-section { padding: 13px 14px 10px; }
.sp-label { font-size: .62rem; font-weight: 700; color: #718096; text-transform: uppercase; letter-spacing: .8px; margin-bottom: 9px; }
.sp-overlay-btns { display: flex; flex-direction: column; gap: 5px; }
.sp-overlay-btns .chip { text-align: left; padding: 6px 11px; width: 100%; }
.sp-divider { border-top: 1px solid rgba(255,255,255,.07); margin: 2px 10px; }
#price-display { font-size: .82rem; font-weight: 700; color: #63b3ed; margin-bottom: 10px; }
#slider { margin: 2px 3px 6px; }

/* ── Overlay legend (inside side panel) ──────────────────────────────────── */
#overlay-legend { padding: 0 14px 14px; display: none; }
#overlay-legend.visible { display: block; }
#overlay-legend .leg-title { font-size: .62rem; font-weight: 700; color: #718096; text-transform: uppercase; letter-spacing: .7px; margin-bottom: 8px; }
.leg-bar { width: 100%; height: 10px; border-radius: 5px; margin-bottom: 4px; }
.leg-bar.election { background: linear-gradient(to right,#003399,#6688ff,#ccccff,#ffcccc,#ff4444,#990000); }
.leg-labels { display: flex; justify-content: space-between; font-size: .62rem; color: #718096; margin-bottom: 2px; }
.leg-labels span.d { color: #6688ff; font-weight: 700; }
.leg-labels span.r { color: #ff4444; font-weight: 700; }
.crime-swatches, .tax-swatches { display: flex; flex-direction: column; gap: 2px; }
.swatch-row { display: flex; align-items: center; gap: 6px; font-size: .63rem; color: #cbd5e0; }
.swatch { width: 12px; height: 12px; border-radius: 2px; flex-shrink: 0; }

/* ── Compare panel ────────────────────────────────────────────────────────── */
#compare-panel {
  position: fixed; bottom: 0; left: 0; right: 0; z-index: 2000;
  background: #16213e; border-top: 2px solid #e94560;
  transform: translateY(100%); transition: transform .3s ease;
  max-height: 55vh; display: flex; flex-direction: column;
}
#compare-panel.open { transform: translateY(0); }
#compare-header {
  display: flex; align-items: center; padding: 10px 16px; gap: 12px;
  background: #0f3460; flex-shrink: 0;
}
#compare-header h3 { font-size: .9rem; font-weight: 700; color: #fff; flex: 1; }
#clear-favs { padding: 3px 10px; border: 1px solid #718096; border-radius: 12px; font-size: .68rem; color: #718096; background: transparent; cursor: pointer; }
#close-compare { background: none; border: none; color: #a0aec0; font-size: 1.2rem; cursor: pointer; padding: 0 4px; }
#compare-scroll { overflow-y: auto; flex: 1; }
#compare-table { width: 100%; border-collapse: collapse; font-size: .72rem; }
#compare-table th { position: sticky; top: 0; background: #0f3460; color: #a0aec0; font-weight: 600; text-transform: uppercase; font-size: .6rem; letter-spacing: .5px; padding: 7px 10px; text-align: left; border-bottom: 1px solid #2d3748; }
#compare-table td { padding: 8px 10px; border-bottom: 1px solid rgba(255,255,255,.05); vertical-align: top; color: #eee; }
#compare-table tr:hover td { background: rgba(255,255,255,.04); }
.td-name { font-weight: 700; color: #e94560; max-width: 150px; }
.td-remove { cursor: pointer; color: #718096; font-size: 1rem; text-align: center; }
.td-remove:hover { color: #e94560; }
.crime-badge, .tax-badge { display: inline-block; padding: 1px 6px; border-radius: 10px; font-size: .63rem; font-weight: 600; }

/* ── Loading spinner ──────────────────────────────────────────────────────── */
#loading-overlay {
  position: absolute; top: 50%; left: 50%; transform: translate(-50%,-50%);
  background: rgba(22,33,62,.92); border-radius: 10px; padding: 14px 22px;
  color: #63b3ed; font-size: .82rem; font-weight: 600; z-index: 2000;
  display: none; align-items: center; gap: 9px;
}
#loading-overlay.visible { display: flex; }
.spinner { width: 18px; height: 18px; border: 3px solid #2d3748; border-top-color: #63b3ed; border-radius: 50%; animation: spin .8s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* County tooltip */
.county-tip {
  background: rgba(22,33,62,.95) !important; border: 1px solid #2d3748 !important;
  color: #eee !important; border-radius: 6px !important; font-size: .75rem !important;
  padding: 6px 10px !important; box-shadow: 0 2px 8px rgba(0,0,0,.5) !important;
  line-height: 1.5 !important;
}
.county-tip::before { display: none !important; }
</style>
</head>
<body>

<div id="header">
  <!-- Row 1: title, type, badges -->
  <div id="header-row1">
    <h1>Florida <span>Gated Communities</span></h1>

    <div class="ctrl-group">
      <span class="ctrl-label">Community Type</span>
      <div id="type-filter" class="chip-row"></div>
    </div>

    <div id="badges">
      <div id="count-badge">228 communities</div>
      <button id="fav-btn" onclick="toggleCompare()">Saved (0)</button>
    </div>
  </div>

  <!-- Row 2: search, amenity filters -->
  <div id="header-row2">
    <div id="search-wrap">
      <span class="ctrl-label">Search</span>
      <input id="search-input" type="text" placeholder="Community name or city&hellip;" oninput="applyFilters()"/>
    </div>

    <div class="ctrl-group">
      <span class="ctrl-label">Must-Have Amenities</span>
      <div id="amenity-filter" class="chip-row"></div>
    </div>
  </div>
</div>

<div id="map">
  <div id="loading-overlay"><div class="spinner"></div>Loading county data&hellip;</div>

  <!-- Panel toggle tab (always visible on map edge) -->
  <button id="panel-toggle" onclick="togglePanel()" title="Toggle filters panel">&#9776;</button>

  <!-- Side panel: price range + overlay + legend -->
  <div id="side-panel" class="open">
    <div class="sp-head">
      <span class="sp-heading">Filters &amp; Layers</span>
      <button class="sp-close" onclick="togglePanel()" title="Close panel">&times;</button>
    </div>

    <div class="sp-section">
      <div class="sp-label">Price Range</div>
      <div id="price-display">$140K &ndash; $10M+</div>
      <div id="slider"></div>
    </div>

    <div class="sp-divider"></div>

    <div class="sp-section">
      <div class="sp-label">Map Overlay</div>
      <div id="overlay-btns" class="sp-overlay-btns">
        <button class="chip elec-btn active" data-overlay="off">Off</button>
        <button class="chip elec-btn" data-overlay="2020">2020 Vote</button>
        <button class="chip elec-btn" data-overlay="2024">2024 Vote</button>
        <button class="chip elec-btn" data-overlay="crime">Crime</button>
        <button class="chip elec-btn" data-overlay="tax">Prop Tax</button>
      </div>
    </div>

    <div class="sp-divider"></div>

    <!-- Legend (shown when an overlay is active) -->
    <div id="overlay-legend">
      <div class="leg-title" id="leg-title">Legend</div>
      <div id="leg-election">
        <div class="leg-bar election"></div>
        <div class="leg-labels"><span class="d">Dem</span><span class="r">Rep</span></div>
      </div>
      <div id="leg-crime" style="display:none">
        <div class="crime-swatches">
          <div class="swatch-row"><div class="swatch" style="background:#2d8e3e"></div>Very Low &lt;75</div>
          <div class="swatch-row"><div class="swatch" style="background:#68d391"></div>Low 75&ndash;125</div>
          <div class="swatch-row"><div class="swatch" style="background:#f6e05e"></div>Moderate 125&ndash;175 <em style="color:#718096">(avg 146)</em></div>
          <div class="swatch-row"><div class="swatch" style="background:#f6ad55"></div>Elevated 175&ndash;225</div>
          <div class="swatch-row"><div class="swatch" style="background:#e53e3e"></div>High &gt;225</div>
        </div>
      </div>
      <div id="leg-tax" style="display:none">
        <div class="tax-swatches">
          <div class="swatch-row"><div class="swatch" style="background:#2d8e3e"></div>Low &lt;0.60%</div>
          <div class="swatch-row"><div class="swatch" style="background:#68d391"></div>Below avg 0.60&ndash;0.72%</div>
          <div class="swatch-row"><div class="swatch" style="background:#f6e05e"></div>Average 0.72&ndash;0.82% <em style="color:#718096">(FL ~0.74%)</em></div>
          <div class="swatch-row"><div class="swatch" style="background:#f6ad55"></div>Above avg 0.82&ndash;0.92%</div>
          <div class="swatch-row"><div class="swatch" style="background:#e53e3e"></div>High &gt;0.92%</div>
        </div>
      </div>
    </div><!-- end overlay-legend -->

  </div><!-- end side-panel -->
</div><!-- end map -->

<!-- Compare / favorites panel -->
<div id="compare-panel">
  <div id="compare-header">
    <h3 id="compare-title">Saved Communities</h3>
    <button id="clear-favs" onclick="clearFavs()">Clear all</button>
    <button id="close-compare" onclick="toggleCompare()">&times;</button>
  </div>
  <div id="compare-scroll">
    <table id="compare-table">
      <thead>
        <tr>
          <th>Community</th><th>City</th><th>Type</th><th>Price Range</th>
          <th>Crime (county)</th><th>Prop Tax</th><th>Amenities</th><th></th>
        </tr>
      </thead>
      <tbody id="compare-body"></tbody>
    </table>
  </div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
<script src="https://cdn.jsdelivr.net/npm/nouislider@15.7.1/dist/nouislider.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/topojson-client@3/dist/topojson-client.min.js"></script>
<script>
const communities  = [{"name": "Andalucia", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Mediterranean-style homes, community pool, gated entry", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.14733, "lng": -81.78862, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Arboretum", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Community pool, lake views, walking paths", "price": "$200K\u2013$400K", "security": "Gated", "lat": 26.14405, "lng": -81.80014, "minPrice": 200.0, "maxPrice": 400.0}, {"name": "Artesia", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, modern homes", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.13912, "lng": -81.78833, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Audubon Country Club", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, tennis, pool, fitness, clubhouse", "price": "$500K\u2013$2M", "security": "Gated", "lat": 26.14874, "lng": -81.78769, "minPrice": 500.0, "maxPrice": 2000.0}, {"name": "Autumn Woods", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Resort-style amenities, pool, community center", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.13695, "lng": -81.78298, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Avery Square", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, walking paths", "price": "$250K\u2013$450K", "security": "Gated", "lat": 26.1337, "lng": -81.78931, "minPrice": 250.0, "maxPrice": 450.0}, {"name": "Banyan Woods", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Community pool, tennis, nature preserve", "price": "$400K\u2013$700K", "security": "Gated", "lat": 26.13403, "lng": -81.80357, "minPrice": 400.0, "maxPrice": 700.0}, {"name": "Barrington Cove", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, playground, modern homes", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.1377, "lng": -81.79102, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Bay Colony", "city": "Naples", "county": "Collier", "type": "Ultra-Luxury", "amenities": "Private beach club, Gulf-view high-rises, exclusive club", "price": "$2M\u2013$20M+", "security": "Guard-gated", "lat": 26.14054, "lng": -81.79758, "minPrice": 2000.0, "maxPrice": 20000.0}, {"name": "Bayfront", "city": "Naples", "county": "Collier", "type": "Condo/Gated", "amenities": "Waterfront, pool, marina access", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.14823, "lng": -81.78828, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Bear's Paw", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Gulf access, championship golf, clubhouse w/ dining", "price": "$400K\u2013$1.5M", "security": "Gated", "lat": 26.14042, "lng": -81.80303, "minPrice": 400.0, "maxPrice": 1500.0}, {"name": "Bent Creek Preserve", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Nature preserve, pool, walking trails", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.14303, "lng": -81.8017, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Berkshire Lakes", "city": "Naples", "county": "Collier", "type": "Affordable Gated", "amenities": "Lakes, walking trails, recreational areas", "price": "$250K\u2013$500K", "security": "Gated", "lat": 26.13387, "lng": -81.79738, "minPrice": 250.0, "maxPrice": 500.0}, {"name": "Black Bear Ridge", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, preserve views", "price": "$400K\u2013$700K", "security": "Gated", "lat": 26.13736, "lng": -81.80078, "minPrice": 400.0, "maxPrice": 700.0}, {"name": "Bridgewater Bay", "city": "Naples", "county": "Collier", "type": "Nature/Gated", "amenities": "Tennis, bocce, pickleball, basketball, clubhouse, steam room, sauna, pool & spa, lap pool", "price": "$300K\u2013$700K", "security": "Gated", "lat": 26.13821, "lng": -81.79064, "minPrice": 300.0, "maxPrice": 700.0}, {"name": "Bristol Pines", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Community pool, fitness, nature preserve", "price": "$350K\u2013$600K", "security": "Gated", "lat": 26.14739, "lng": -81.80076, "minPrice": 350.0, "maxPrice": 600.0}, {"name": "Cascades", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, clubhouse, walking trails", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.13453, "lng": -81.79982, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Cedar Hammock", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis, fitness", "price": "$140K\u2013$800K", "security": "Gated", "lat": 26.13736, "lng": -81.78297, "minPrice": 140.0, "maxPrice": 800.0}, {"name": "Collier's Reserve", "city": "Naples", "county": "Collier", "type": "Golf/Nature", "amenities": "Audubon sanctuary, golf course along Cocohatchee River, clubhouse", "price": "$800K\u2013$3M+", "security": "Guard-gated", "lat": 26.14582, "lng": -81.79469, "minPrice": 800.0, "maxPrice": 3000.0}, {"name": "Compass Landing", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, modern community", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.13928, "lng": -81.79616, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Copper Cove Preserve", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Nature preserve, pool, community center", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.14409, "lng": -81.78911, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Countryside Golf & CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, tennis, clubhouse, fitness, pool", "price": "$200K\u2013$600K", "security": "Gated", "lat": 26.13732, "lng": -81.7877, "minPrice": 200.0, "maxPrice": 600.0}, {"name": "Cypress Woods", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, condos & villas, clubhouse", "price": "$200K\u2013$500K", "security": "Gated", "lat": 26.13914, "lng": -81.79135, "minPrice": 200.0, "maxPrice": 500.0}, {"name": "Eagle Creek", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, tennis, clubhouse, fitness, 300+ acres of cypress/pine/palm", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.1433, "lng": -81.78724, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Esplanade Golf & CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf, tennis, wellness, affordable luxury", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.13979, "lng": -81.78449, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Estates at Bay Colony", "city": "Naples", "county": "Collier", "type": "Ultra-Luxury", "amenities": "Private Bay Colony amenities, estate lots", "price": "$3M\u2013$15M+", "security": "Guard-gated", "lat": 26.13887, "lng": -81.78337, "minPrice": 3000.0, "maxPrice": 15000.0}, {"name": "Estuary at Grey Oaks", "city": "Naples", "county": "Collier", "type": "Luxury Golf", "amenities": "Grey Oaks amenities, waterfront estate lots", "price": "$2M\u2013$10M+", "security": "Guard-gated", "lat": 26.14684, "lng": -81.8002, "minPrice": 2000.0, "maxPrice": 10000.0}, {"name": "Falling Waters", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Waterfalls, pool, tennis, nature setting", "price": "$200K\u2013$400K", "security": "Gated", "lat": 26.13413, "lng": -81.80428, "minPrice": 200.0, "maxPrice": 400.0}, {"name": "Fiddler's Creek", "city": "Naples", "county": "Collier", "type": "Master-Planned Golf", "amenities": "18-hole golf, 54,000 sq ft clubhouse, spa, pool, tennis, pickleball, dining, 4,000 acres", "price": "$300K\u2013$3M+", "security": "Gated", "lat": 26.1358, "lng": -81.7843, "minPrice": 300.0, "maxPrice": 3000.0}, {"name": "Forest Glen", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis", "price": "$200K\u2013$500K", "security": "Gated", "lat": 26.14732, "lng": -81.79821, "minPrice": 200.0, "maxPrice": 500.0}, {"name": "Foxfire Golf & CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, tennis, pool", "price": "$150K\u2013$400K", "security": "Gated", "lat": 26.13693, "lng": -81.78504, "minPrice": 150.0, "maxPrice": 400.0}, {"name": "Fronterra", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, modern homes", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.1335, "lng": -81.79622, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Glen Eagle Golf & CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, fitness, pool, tennis", "price": "$200K\u2013$600K", "security": "Gated", "lat": 26.14449, "lng": -81.78784, "minPrice": 200.0, "maxPrice": 600.0}, {"name": "Greyhawk", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, resort amenities", "price": "$400K\u2013$1M", "security": "Gated", "lat": 26.14163, "lng": -81.78421, "minPrice": 400.0, "maxPrice": 1000.0}, {"name": "Grey Oaks Country Club", "city": "Naples", "county": "Collier", "type": "Luxury Golf", "amenities": "3 championship golf courses, 62,000 sq ft clubhouse, dining, tennis, pickleball, pool, spa, fitness", "price": "$1M\u2013$15M+", "security": "24-hr guard gate", "lat": 26.15044, "lng": -81.784, "minPrice": 1000.0, "maxPrice": 15000.0}, {"name": "Hacienda Lakes", "city": "Naples", "county": "Collier", "type": "Master-Planned", "amenities": "Pool, fitness, trails, parks, multiple builders", "price": "$300K\u2013$1.5M", "security": "Gated", "lat": 26.14554, "lng": -81.80581, "minPrice": 300.0, "maxPrice": 1500.0}, {"name": "Hammock Bay", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, waterfront, pool", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.14714, "lng": -81.78778, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Heritage Bay", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, fitness", "price": "$200K\u2013$500K", "security": "Gated", "lat": 26.15006, "lng": -81.7833, "minPrice": 200.0, "maxPrice": 500.0}, {"name": "Hyde Park at Pelican Bay", "city": "Naples", "county": "Collier", "type": "Luxury", "amenities": "Pelican Bay amenities, beach club access", "price": "$500K\u2013$2M", "security": "Gated", "lat": 26.14909, "lng": -81.79239, "minPrice": 500.0, "maxPrice": 2000.0}, {"name": "Imperial Golf Estates", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.14673, "lng": -81.7848, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Indigo Lakes", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, lake views", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.1489, "lng": -81.78457, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Island Walk", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, tennis, clubhouse, lake setting", "price": "$300K\u2013$700K", "security": "Gated", "lat": 26.14728, "lng": -81.78891, "minPrice": 300.0, "maxPrice": 700.0}, {"name": "Isles of Collier Preserve", "city": "Naples", "county": "Collier", "type": "Eco-Luxury", "amenities": "Clubhouse, fitness, pool, kayak launch, trails, nature preserve, overlook pier", "price": "$400K\u2013$1.5M", "security": "Gated", "lat": 26.14735, "lng": -81.80407, "minPrice": 400.0, "maxPrice": 1500.0}, {"name": "Kalea Bay", "city": "Naples", "county": "Collier", "type": "Luxury Condo/Gated", "amenities": "Rooftop amenities, pool, fitness, waterfront tower condos", "price": "$1M\u2013$5M+", "security": "Gated", "lat": 26.14407, "lng": -81.79073, "minPrice": 1000.0, "maxPrice": 5000.0}, {"name": "Kensington Golf & CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, tennis, pool, fitness", "price": "$400K\u2013$1.5M", "security": "Guard-gated", "lat": 26.14595, "lng": -81.80165, "minPrice": 400.0, "maxPrice": 1500.0}, {"name": "Lantana at Olde Cypress", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Olde Cypress golf course access, pool, clubhouse", "price": "$400K\u2013$800K", "security": "Gated", "lat": 26.14141, "lng": -81.80545, "minPrice": 400.0, "maxPrice": 800.0}, {"name": "Lely Resort", "city": "Naples", "county": "Collier", "type": "Golf/Resort", "amenities": "3 golf courses, Players Club & Spa, multiple pools, tennis, fitness, dining", "price": "$200K\u2013$2M", "security": "Gated", "lat": 26.14316, "lng": -81.79585, "minPrice": 200.0, "maxPrice": 2000.0}, {"name": "Livingston Lakes", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, lakefront setting", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.14397, "lng": -81.79582, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Longshore Lake", "city": "Naples", "county": "Collier", "type": "Gated/Waterfront", "amenities": "Lake, boating, fishing, clubhouse, pool, tennis", "price": "$400K\u2013$1.2M", "security": "Gated", "lat": 26.13654, "lng": -81.79777, "minPrice": 400.0, "maxPrice": 1200.0}, {"name": "Mandalay Place", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, modern homes", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.14652, "lng": -81.79371, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Marbella Isles", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, lake views", "price": "$400K\u2013$700K", "security": "Gated", "lat": 26.14898, "lng": -81.79544, "minPrice": 400.0, "maxPrice": 700.0}, {"name": "Marsilea", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, contemporary design", "price": "$400K\u2013$700K", "security": "Gated", "lat": 26.14829, "lng": -81.80457, "minPrice": 400.0, "maxPrice": 700.0}, {"name": "Mediterra", "city": "Naples", "county": "Collier", "type": "Luxury Golf", "amenities": "2 Tom Fazio golf courses, private beach club, pool, dining, fitness, spa, 8 mi trails, tennis", "price": "$800K\u2013$7M+", "security": "Guard-gated", "lat": 26.13986, "lng": -81.80291, "minPrice": 800.0, "maxPrice": 7000.0}, {"name": "Miralia", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, newer community", "price": "$400K\u2013$700K", "security": "Gated", "lat": 26.13314, "lng": -81.80592, "minPrice": 400.0, "maxPrice": 700.0}, {"name": "Montebello at Coco Lakes", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, lake setting", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.14412, "lng": -81.80643, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Moon Lake", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Lakefront, pool, community amenities", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.13352, "lng": -81.79361, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Mystique at Pelican Bay", "city": "Naples", "county": "Collier", "type": "Luxury Condo", "amenities": "Pelican Bay beach clubs, tower condos, Gulf views", "price": "$2M\u2013$8M+", "security": "Gated", "lat": 26.1476, "lng": -81.78561, "minPrice": 2000.0, "maxPrice": 8000.0}, {"name": "Naples Bay Resort & Marina", "city": "Naples", "county": "Collier", "type": "Resort/Gated", "amenities": "Marina, pool, spa, fitness, hotel services, waterfront dining", "price": "$300K\u2013$2M", "security": "Gated", "lat": 26.14325, "lng": -81.79347, "minPrice": 300.0, "maxPrice": 2000.0}, {"name": "Naples Heritage", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis", "price": "$200K\u2013$500K", "security": "Gated", "lat": 26.14445, "lng": -81.80489, "minPrice": 200.0, "maxPrice": 500.0}, {"name": "Naples Lakes CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course (Arnold Palmer), clubhouse, pool, fitness", "price": "$200K\u2013$600K", "security": "Gated", "lat": 26.13304, "lng": -81.80143, "minPrice": 200.0, "maxPrice": 600.0}, {"name": "Naples Reserve", "city": "Naples", "county": "Collier", "type": "Waterfront", "amenities": "Private Eagle Lake beach, lagoon pool, hot tub, Gator Grille, fitness, kayaking, trails", "price": "$300K\u2013$1.5M", "security": "Gated", "lat": 26.13366, "lng": -81.78879, "minPrice": 300.0, "maxPrice": 1500.0}, {"name": "National Golf & CC", "city": "Ave Maria", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, fitness, family amenities", "price": "$240K\u2013$800K", "security": "Gated", "lat": 26.40461, "lng": -81.51364, "minPrice": 240.0, "maxPrice": 800.0}, {"name": "Olde Cypress", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course (P.B. Dye), clubhouse, pool, tennis, fitness", "price": "$500K\u2013$2M", "security": "Guard-gated", "lat": 26.13559, "lng": -81.78594, "minPrice": 500.0, "maxPrice": 2000.0}, {"name": "Panther Run (Ave Maria)", "city": "Ave Maria", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse amenities", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.40279, "lng": -81.51478, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Pelican Bay", "city": "Naples", "county": "Collier", "type": "Master-Planned", "amenities": "2 private beach clubs, tram to beach, community center, fitness, tennis, trails, Artis-Naples access", "price": "$300K\u2013$10M+", "security": "Controlled access", "lat": 26.15067, "lng": -81.80183, "minPrice": 300.0, "maxPrice": 10000.0}, {"name": "Pelican Marsh", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, fitness, pool, tennis, nature preserve", "price": "$400K\u2013$3M", "security": "Guard-gated", "lat": 26.13674, "lng": -81.80613, "minPrice": 400.0, "maxPrice": 3000.0}, {"name": "Port Royal", "city": "Naples", "county": "Collier", "type": "Ultra-Luxury", "amenities": "Port Royal Club, beach club, dining, tennis, yacht docks, direct Gulf access", "price": "$5M\u2013$60M+", "security": "Guard-gated", "lat": 26.13821, "lng": -81.79254, "minPrice": 5000.0, "maxPrice": 60000.0}, {"name": "Quail Creek", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis, fitness", "price": "$500K\u2013$3M", "security": "Guard-gated", "lat": 26.14648, "lng": -81.79808, "minPrice": 500.0, "maxPrice": 3000.0}, {"name": "Quail West", "city": "Naples", "county": "Collier", "type": "Luxury Estate", "amenities": "2 Arthur Hills golf courses, 70,000 sq ft clubhouse, spa, fitness, pool, estates 4,000-10,000+ sq ft", "price": "$800K\u2013$8M+", "security": "Guard-gated", "lat": 26.14004, "lng": -81.78311, "minPrice": 800.0, "maxPrice": 8000.0}, {"name": "Raffia Preserve", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, nature preserve", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.1355, "lng": -81.78636, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Reflection Lakes", "city": "Naples", "county": "Collier", "type": "Affordable Gated", "amenities": "Pool, resort-like feel, affordable homes & townhouses", "price": "$250K\u2013$450K", "security": "Gated", "lat": 26.14569, "lng": -81.79184, "minPrice": 250.0, "maxPrice": 450.0}, {"name": "Regatta", "city": "Naples", "county": "Collier", "type": "Gated/Waterfront", "amenities": "Pool, waterfront setting, fitness", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.14211, "lng": -81.78648, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Riverstone", "city": "Naples", "county": "Collier", "type": "Family Gated", "amenities": "Parks, playgrounds, pool, fitness, family-friendly", "price": "$400K\u2013$800K", "security": "Gated", "lat": 26.13432, "lng": -81.79171, "minPrice": 400.0, "maxPrice": 800.0}, {"name": "Royal Wood", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool", "price": "$150K\u2013$400K", "security": "Gated", "lat": 26.13371, "lng": -81.78722, "minPrice": 150.0, "maxPrice": 400.0}, {"name": "Saturnia Lakes", "city": "Naples", "county": "Collier", "type": "Family Gated", "amenities": "Clubhouse, fitness, game room, studio, 3 pools, hot tub, cabanas, basketball/tennis/bocce", "price": "$400K\u2013$800K", "security": "Security gate", "lat": 26.1428, "lng": -81.78336, "minPrice": 400.0, "maxPrice": 800.0}, {"name": "SkySail", "city": "Naples", "county": "Collier", "type": "New Gated", "amenities": "Community center, pool, fitness, sport-courts, fishing, kayaking, trails, pet parks", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.1428, "lng": -81.79793, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "StoneCreek", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, community center", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.13464, "lng": -81.78368, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Stonebridge CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis", "price": "$300K\u2013$700K", "security": "Gated", "lat": 26.14571, "lng": -81.79806, "minPrice": 300.0, "maxPrice": 700.0}, {"name": "Strada at Mercato", "city": "Naples", "county": "Collier", "type": "Urban Gated", "amenities": "Urban luxury, walkable to Mercato shops/dining", "price": "$500K\u2013$1.5M", "security": "Gated", "lat": 26.14561, "lng": -81.79993, "minPrice": 500.0, "maxPrice": 1500.0}, {"name": "Talis Park", "city": "Naples", "county": "Collier", "type": "Luxury Golf", "amenities": "Championship golf, fitness & wellness center, waterfront club, tiki bar, boating, spa, pool", "price": "$700K\u2013$5M+", "security": "Guard-gated", "lat": 26.14784, "lng": -81.79514, "minPrice": 700.0, "maxPrice": 5000.0}, {"name": "The Quarry", "city": "Naples", "county": "Collier", "type": "Golf/Lake", "amenities": "Golf course, 14 lakes, water park, kayaking, clubhouse, fitness", "price": "$300K\u2013$1.5M", "security": "Gated", "lat": 26.13816, "lng": -81.7964, "minPrice": 300.0, "maxPrice": 1500.0}, {"name": "The Strand", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis, fitness", "price": "$400K\u2013$2M", "security": "Guard-gated", "lat": 26.14616, "lng": -81.78492, "minPrice": 400.0, "maxPrice": 2000.0}, {"name": "Tibur\u00f3n", "city": "Naples", "county": "Collier", "type": "Resort/Golf", "amenities": "2 Greg Norman golf courses, 27,000 sq ft clubhouse, Ritz-Carlton on-site, spa, tennis, dining", "price": "$500K\u2013$5M+", "security": "Gated", "lat": 26.14073, "lng": -81.78533, "minPrice": 500.0, "maxPrice": 5000.0}, {"name": "Treviso Bay", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "TPC golf course, clubhouse, pool, fitness, resort amenities", "price": "$400K\u2013$3M", "security": "Gated", "lat": 26.1354, "lng": -81.79453, "minPrice": 400.0, "maxPrice": 3000.0}, {"name": "Tuscany Point", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, community amenities", "price": "$250K\u2013$450K", "security": "Gated", "lat": 26.13485, "lng": -81.7844, "minPrice": 250.0, "maxPrice": 450.0}, {"name": "Twin Eagles", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "2 golf courses, clubhouse, pool, tennis, fitness, dining", "price": "$400K\u2013$2M", "security": "Guard-gated", "lat": 26.13605, "lng": -81.79676, "minPrice": 400.0, "maxPrice": 2000.0}, {"name": "Valencia Golf & CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, fitness, tennis", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.14711, "lng": -81.79536, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Vanderbilt CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis, fitness", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.14717, "lng": -81.78984, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Verona Walk", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, clubhouse, walking trails, town center feel", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.14995, "lng": -81.78598, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Village Walk", "city": "Naples (North)", "county": "Collier", "type": "Resort-Style", "amenities": "Community center, 2 resort pools, fitness, 8 tennis courts, 2 bocce courts, bike/jog trails", "price": "$400K\u2013$1M+", "security": "Gated", "lat": 26.22716, "lng": -81.78349, "minPrice": 400.0, "maxPrice": 1000.0}, {"name": "The Vineyards", "city": "Naples", "county": "Collier", "type": "Golf/Family", "amenities": "Golf courses, tennis, clubhouse, pool, family-friendly, top schools", "price": "$300K\u2013$1.5M", "security": "Gated", "lat": 26.14323, "lng": -81.78342, "minPrice": 300.0, "maxPrice": 1500.0}, {"name": "Wilderness CC", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis", "price": "$300K\u2013$1M", "security": "Gated", "lat": 26.13433, "lng": -81.79303, "minPrice": 300.0, "maxPrice": 1000.0}, {"name": "Wilshire Lakes", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, tennis, community center", "price": "$400K\u2013$800K", "security": "Gated", "lat": 26.14532, "lng": -81.79236, "minPrice": 400.0, "maxPrice": 800.0}, {"name": "Winding Cypress", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, nature setting", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.14302, "lng": -81.80463, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Windstar", "city": "Naples", "county": "Collier", "type": "Golf/Marina", "amenities": "Golf course, marina, waterfront, clubhouse", "price": "$400K\u2013$2M", "security": "Gated", "lat": 26.14603, "lng": -81.78395, "minPrice": 400.0, "maxPrice": 2000.0}, {"name": "Windward Isle", "city": "Naples", "county": "Collier", "type": "Gated", "amenities": "Pool, fitness, newer homes", "price": "$400K\u2013$700K", "security": "Gated", "lat": 26.14194, "lng": -81.79677, "minPrice": 400.0, "maxPrice": 700.0}, {"name": "Wyndemere", "city": "Naples", "county": "Collier", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, tennis, pool, fitness", "price": "$300K\u2013$1.5M", "security": "Guard-gated", "lat": 26.13593, "lng": -81.79344, "minPrice": 300.0, "maxPrice": 1500.0}, {"name": "Bella Terra", "city": "Estero", "county": "Lee", "type": "Gated", "amenities": "Pool, fitness, lake views, walking trails", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.44343, "lng": -81.81721, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Bonita Bay Club", "city": "Bonita Springs", "county": "Lee", "type": "Luxury Golf", "amenities": "5 championship golf courses, fitness, spa, beach park, tennis, pickleball, marina, dining", "price": "$500K\u2013$5M+", "security": "Guard-gated", "lat": 26.34393, "lng": -81.78577, "minPrice": 500.0, "maxPrice": 5000.0}, {"name": "Bonita Isles", "city": "Bonita Springs", "county": "Lee", "type": "Gated", "amenities": "Pool, cabanas, fitness, tennis, pickleball, tot lot, 2 lakes", "price": "$300K\u2013$600K", "security": "Gated", "lat": 26.33968, "lng": -81.77213, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Bonita Landing", "city": "Bonita Springs", "county": "Lee", "type": "Gated", "amenities": "40-acre lake, fishing dock, basketball courts, pool", "price": "$300K\u2013$500K", "security": "Gated", "lat": 26.3334, "lng": -81.7804, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "The Colony Golf & CC", "city": "Bonita Springs", "county": "Lee", "type": "Luxury Golf/Condo", "amenities": "Golf & country club, luxury high-rises, estate homes, pool, fitness", "price": "$500K\u2013$3M+", "security": "Guard-gated", "lat": 26.34818, "lng": -81.77418, "minPrice": 500.0, "maxPrice": 3000.0}, {"name": "Grandezza", "city": "Estero", "county": "Lee", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, fitness, tennis", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.43763, "lng": -81.813, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Gulf Harbour Yacht & CC", "city": "Fort Myers", "county": "Lee", "type": "Yacht/Golf", "amenities": "Deep-water marina, golf course, clubhouse, pool, tennis, dining, waterfront", "price": "$400K\u2013$3M+", "security": "Guard-gated", "lat": 26.64689, "lng": -81.87334, "minPrice": 400.0, "maxPrice": 3000.0}, {"name": "Miromar Lakes Beach & Golf", "city": "Estero", "county": "Lee", "type": "Lakefront Luxury", "amenities": "700-acre lake, beachfront, Arthur Hills golf, European spa, fitness, 3 restaurants, water sports", "price": "$500K\u2013$5M+", "security": "Guard-gated", "lat": 26.4334, "lng": -81.80266, "minPrice": 500.0, "maxPrice": 5000.0}, {"name": "Paseo", "city": "Fort Myers", "county": "Lee", "type": "Gated", "amenities": "Pool, fitness, clubhouse, walking trails, restaurants, shops within community", "price": "$300K\u2013$800K", "security": "Gated", "lat": 26.63541, "lng": -81.86434, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Pelican Landing", "city": "Bonita Springs", "county": "Lee", "type": "Golf/Nature", "amenities": "Golf, private beach park, canoe park, tennis, pool, fitness, nature trails", "price": "$300K\u2013$2M", "security": "Gated", "lat": 26.33662, "lng": -81.77819, "minPrice": 300.0, "maxPrice": 2000.0}, {"name": "The Plantation Golf & CC", "city": "Fort Myers", "county": "Lee", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, tennis, pool, fitness", "price": "$300K\u2013$1.5M", "security": "Gated", "lat": 26.6325, "lng": -81.86747, "minPrice": 300.0, "maxPrice": 1500.0}, {"name": "The Preserve at Corkscrew", "city": "Estero", "county": "Lee", "type": "Gated/Nature", "amenities": "Nature preserve, pool, fitness, trails", "price": "$300K\u2013$700K", "security": "Gated", "lat": 26.43563, "lng": -81.80759, "minPrice": 300.0, "maxPrice": 700.0}, {"name": "Renaissance Golf & CC", "city": "Fort Myers", "county": "Lee", "type": "Golf/Gated", "amenities": "Championship golf, spa, clubhouse dining, boutique luxury", "price": "$400K\u2013$1.5M", "security": "Gated", "lat": 26.63704, "lng": -81.86103, "minPrice": 400.0, "maxPrice": 1500.0}, {"name": "Shadow Wood (at the Brooks)", "city": "Bonita Springs", "county": "Lee", "type": "Golf/Gated", "amenities": "3 golf courses, clubhouse, fitness, pool, tennis, nature preserve", "price": "$400K\u2013$2M+", "security": "Guard-gated", "lat": 26.34108, "lng": -81.76704, "minPrice": 400.0, "maxPrice": 2000.0}, {"name": "Shadow Wood Preserve", "city": "Fort Myers", "county": "Lee", "type": "Gated", "amenities": "Nature preserve, pool, fitness, walking trails", "price": "$300K\u2013$700K", "security": "Gated", "lat": 26.64864, "lng": -81.86228, "minPrice": 300.0, "maxPrice": 700.0}, {"name": "Verandah", "city": "Fort Myers", "county": "Lee", "type": "Golf/River", "amenities": "2 golf courses, riverfront clubhouse, pool, tennis, fitness, marina, kayaking", "price": "$300K\u2013$1M", "security": "Gated", "lat": 26.63204, "lng": -81.873, "minPrice": 300.0, "maxPrice": 1000.0}, {"name": "West Bay Beach & Golf", "city": "Estero", "county": "Lee", "type": "Golf/Gated", "amenities": "Golf course, beach access, clubhouse, pool, fitness", "price": "$400K\u2013$1.5M", "security": "Gated", "lat": 26.43757, "lng": -81.80959, "minPrice": 400.0, "maxPrice": 1500.0}, {"name": "Wildcat Run Golf & CC", "city": "Estero", "county": "Lee", "type": "Golf/Gated", "amenities": "Golf course (Arnold Palmer), clubhouse, pool, tennis", "price": "$300K\u2013$1M", "security": "Gated", "lat": 26.43749, "lng": -81.80364, "minPrice": 300.0, "maxPrice": 1000.0}, {"name": "Boca Royale Golf & CC", "city": "Englewood", "county": "Sarasota", "type": "Golf/Coastal", "amenities": "Golf course, resort amenities, clubhouse, pool, fitness, 15 min from beaches", "price": "$200K\u2013$800K", "security": "Gated", "lat": 26.96454, "lng": -82.34862, "minPrice": 200.0, "maxPrice": 800.0}, {"name": "Country Club East", "city": "Lakewood Ranch", "county": "Manatee", "type": "Golf/Luxury", "amenities": "Golf course, fully staffed gate, clubhouse, pool, tennis, fitness", "price": "$500K\u2013$2M+", "security": "Staffed guard gate", "lat": 27.40687, "lng": -82.38189, "minPrice": 500.0, "maxPrice": 2000.0}, {"name": "The Founders Club", "city": "Sarasota", "county": "Sarasota", "type": "Luxury Golf", "amenities": "Robert Trent Jones Jr. golf course, clubhouse, dining, fitness, resort pool, tennis", "price": "$700K\u2013$3M+", "security": "Guard-gated", "lat": 27.33796, "lng": -82.52067, "minPrice": 700.0, "maxPrice": 3000.0}, {"name": "Hampton Lakes", "city": "Sarasota", "county": "Sarasota", "type": "Gated", "amenities": "Pool, fitness, newer construction", "price": "$300K\u2013$600K", "security": "Gated", "lat": 27.34071, "lng": -82.53168, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Heron Landing", "city": "Sarasota", "county": "Sarasota", "type": "Gated", "amenities": "Pool, fitness, walking trails", "price": "$300K\u2013$500K", "security": "Gated", "lat": 27.34316, "lng": -82.53451, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Lakewood National", "city": "Lakewood Ranch", "county": "Manatee", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, fitness", "price": "$300K\u2013$700K", "security": "Gated", "lat": 27.40555, "lng": -82.39134, "minPrice": 300.0, "maxPrice": 700.0}, {"name": "Lakewood Ranch Golf & CC", "city": "Lakewood Ranch", "county": "Manatee", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, fitness, pool, tennis, trails, events", "price": "$300K\u2013$2M+", "security": "Gated", "lat": 27.40668, "lng": -82.39245, "minPrice": 300.0, "maxPrice": 2000.0}, {"name": "Miramar", "city": "Lakewood Ranch", "county": "Manatee", "type": "Gated", "amenities": "Pool, fitness, walking trails", "price": "$300K\u2013$600K", "security": "Gated", "lat": 27.41292, "lng": -82.38487, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Monterey at Lakewood Ranch", "city": "Lakewood Ranch", "county": "Manatee", "type": "Luxury Gated", "amenities": "Toll Brothers homes, pool, fitness", "price": "$500K\u2013$1.5M", "security": "Gated", "lat": 27.40006, "lng": -82.39246, "minPrice": 500.0, "maxPrice": 1500.0}, {"name": "The Moorings (LWR)", "city": "Lakewood Ranch", "county": "Manatee", "type": "Gated", "amenities": "Pool, fitness, lake views", "price": "$400K\u2013$800K", "security": "Gated", "lat": 27.40773, "lng": -82.39984, "minPrice": 400.0, "maxPrice": 800.0}, {"name": "Palm Grove", "city": "Lakewood Ranch", "county": "Manatee", "type": "Gated", "amenities": "Pool, fitness, modern amenities", "price": "$300K\u2013$600K", "security": "Gated", "lat": 27.40707, "lng": -82.38294, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Polo Run", "city": "Lakewood Ranch", "county": "Manatee", "type": "Gated", "amenities": "Pool, fitness, clubhouse", "price": "$300K\u2013$600K", "security": "Gated", "lat": 27.41239, "lng": -82.39635, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Rosedale Golf & CC", "city": "Lakewood Ranch/Bradenton", "county": "Manatee", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, tennis, fitness", "price": "$300K\u2013$800K", "security": "Gated", "lat": 27.40159, "lng": -82.41491, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Star Farms at Lakewood Ranch", "city": "Lakewood Ranch", "county": "Manatee", "type": "Resort-Style Gated", "amenities": "1,300-acre village, resort amenities, pool, fitness, trails", "price": "$300K\u2013$800K", "security": "Gated", "lat": 27.40503, "lng": -82.37992, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Watercrest at Lakewood Ranch", "city": "Lakewood Ranch", "county": "Manatee", "type": "Gated", "amenities": "Pool, fitness, lake views", "price": "$300K\u2013$600K", "security": "Gated", "lat": 27.41222, "lng": -82.39112, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Wildgrass", "city": "Sarasota", "county": "Sarasota", "type": "Gated", "amenities": "Pool, fitness, nature setting", "price": "$300K\u2013$600K", "security": "Gated", "lat": 27.33649, "lng": -82.53364, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Cocoplum", "city": "Coral Gables", "county": "Miami-Dade", "type": "Luxury Waterfront", "amenities": "Clubhouse, fitness, tennis, playground, yacht club, 24-hr security, 300 homes", "price": "$2.5M\u2013$16M", "security": "24-hr security", "lat": 25.71996, "lng": -80.27985, "minPrice": 2500.0, "maxPrice": 16000.0}, {"name": "Fisher Island", "city": "Miami Beach", "county": "Miami-Dade", "type": "Ultra-Luxury Island", "amenities": "Private ferry, hotel, beach, 9-hole golf, 17 tennis courts, 2 marinas, spa, fitness, dining, medical, school", "price": "$3M\u2013$50M+", "security": "Private island/ferry", "lat": 25.78488, "lng": -80.12448, "minPrice": 3000.0, "maxPrice": 50000.0}, {"name": "Gables Estates", "city": "Coral Gables", "county": "Miami-Dade", "type": "Ultra-Luxury", "amenities": "Wide canals, no-bridge Bay access, tennis, lots 30K\u2013200K SF", "price": "$4.5M\u2013$45M+", "security": "Guard-gated", "lat": 25.72675, "lng": -80.26769, "minPrice": 4500.0, "maxPrice": 45000.0}, {"name": "Golden Beach", "city": "Golden Beach", "county": "Miami-Dade", "type": "Incorporated Village", "amenities": "Own police force, beachfront, park, extreme privacy", "price": "$5M\u2013$30M+", "security": "Own police dept", "lat": 25.98207, "lng": -80.12903, "minPrice": 5000.0, "maxPrice": 30000.0}, {"name": "Hammock Lakes", "city": "Coral Gables", "county": "Miami-Dade", "type": "Luxury", "amenities": "Built around 2 lakes, private, Old Cutler Road location", "price": "$2M\u2013$8M+", "security": "Gated", "lat": 25.71397, "lng": -80.2778, "minPrice": 2000.0, "maxPrice": 8000.0}, {"name": "Hughes Cove", "city": "Coconut Grove", "county": "Miami-Dade", "type": "Waterfront Luxury", "amenities": "Waterfront, marina, clubhouse, pool, gym, tennis, private beach", "price": "$3M\u2013$12M+", "security": "Gated", "lat": 25.72694, "lng": -80.24906, "minPrice": 3000.0, "maxPrice": 12000.0}, {"name": "Key Biscayne (various)", "city": "Key Biscayne", "county": "Miami-Dade", "type": "Island Community", "amenities": "Golf course, beaches, yacht club, beach clubs, parks, tennis", "price": "$1M\u2013$30M+", "security": "Bridge access", "lat": 25.68483, "lng": -80.1506, "minPrice": 1000.0, "maxPrice": 30000.0}, {"name": "Morningside Park area", "city": "Miami", "county": "Miami-Dade", "type": "Gated", "amenities": "Basketball, volleyball, tennis, BBQ, boat ramp, historic charm", "price": "$800K\u2013$5M+", "security": "Gated", "lat": 25.76155, "lng": -80.19271, "minPrice": 800.0, "maxPrice": 5000.0}, {"name": "Ocean Reef Club", "city": "Key Largo", "county": "Monroe", "type": "Luxury Private Club", "amenities": "Private marina, golf courses, tennis, private airport, medical center, dining, spa", "price": "$2M\u2013$30M+", "security": "Guard-gated", "lat": 25.08509, "lng": -80.4381, "minPrice": 2000.0, "maxPrice": 30000.0}, {"name": "Old Cutler Bay", "city": "Miami", "county": "Miami-Dade", "type": "Family Luxury", "amenities": "136 homes, tennis courts, park setting, near top schools", "price": "$2M\u2013$10M+", "security": "Guard-gated", "lat": 25.76326, "lng": -80.19631, "minPrice": 2000.0, "maxPrice": 10000.0}, {"name": "Palm Island", "city": "Miami Beach", "county": "Miami-Dade", "type": "Luxury Island", "amenities": "Park w/ basketball, 3 tennis courts, playground, waterfront", "price": "$4M\u2013$20M+", "security": "Guard-gated", "lat": 25.78766, "lng": -80.11948, "minPrice": 4000.0, "maxPrice": 20000.0}, {"name": "Hibiscus Island", "city": "Miami Beach", "county": "Miami-Dade", "type": "Luxury Island", "amenities": "Private security, waterfront, close to South Beach", "price": "$4M\u2013$20M+", "security": "Guard-gated", "lat": 25.79599, "lng": -80.13668, "minPrice": 4000.0, "maxPrice": 20000.0}, {"name": "Star Island", "city": "Miami Beach", "county": "Miami-Dade", "type": "Ultra-Luxury Island", "amenities": "35 waterfront homes, celebrity enclave, private security", "price": "$30M\u2013$100M+", "security": "Guard-gated", "lat": 25.79643, "lng": -80.13053, "minPrice": 30000.0, "maxPrice": 100000.0}, {"name": "Sunset Islands", "city": "Miami Beach", "county": "Miami-Dade", "type": "Luxury Islands", "amenities": "24/7 guard-gated, 50\u201380 homes per island, Biscayne Bay", "price": "$4.7M\u2013$20M+", "security": "24/7 guard-gated", "lat": 25.78638, "lng": -80.13511, "minPrice": 4700.0, "maxPrice": 20000.0}, {"name": "Tahiti Beach (in Cocoplum)", "city": "Coral Gables", "county": "Miami-Dade", "type": "Ultra-Luxury", "amenities": "29 homes, most direct oceanfront, within Cocoplum", "price": "$10M\u2013$30M+", "security": "Double-gated", "lat": 25.7219, "lng": -80.26475, "minPrice": 10000.0, "maxPrice": 30000.0}, {"name": "The Moorings (Grove)", "city": "Coconut Grove", "county": "Miami-Dade", "type": "Waterfront Luxury", "amenities": "37 homes, park, boat docks, no-bridge Bay access", "price": "$4.7M\u2013$12.5M", "security": "Gated", "lat": 25.73203, "lng": -80.23256, "minPrice": 4700.0, "maxPrice": 12500.0}, {"name": "Casa de Campo", "city": "Miami", "county": "Miami-Dade", "type": "Gated", "amenities": "72 homes, Mediterranean courtyards, electronic gate", "price": "$500K\u2013$1.2M", "security": "Electronic gate", "lat": 25.7652, "lng": -80.18942, "minPrice": 500.0, "maxPrice": 1200.0}, {"name": "Old Cutler Grove South", "city": "Miami", "county": "Miami-Dade", "type": "Gated", "amenities": "16 homes, 2 tennis courts, walled enclave", "price": "$1M\u2013$3M", "security": "Walled/gated", "lat": 25.76946, "lng": -80.20298, "minPrice": 1000.0, "maxPrice": 3000.0}, {"name": "Royal Harbour", "city": "Palmetto Bay", "county": "Miami-Dade", "type": "Waterfront Gated", "amenities": "Private island townhomes, marina, 24-hr manned security, bayfront", "price": "$800K\u2013$2M+", "security": "24-hr manned", "lat": 25.62425, "lng": -80.33943, "minPrice": 800.0, "maxPrice": 2000.0}, {"name": "Bay Colony", "city": "Fort Lauderdale", "county": "Broward", "type": "Luxury Waterfront", "amenities": "Private marina, 24/7 security, Intracoastal access, near Pine Crest School", "price": "$2M\u2013$15M+", "security": "Guard-gated", "lat": 26.12094, "lng": -80.14008, "minPrice": 2000.0, "maxPrice": 15000.0}, {"name": "The Enclave at Coral Ridge CC", "city": "Fort Lauderdale", "county": "Broward", "type": "Luxury Golf", "amenities": "Coral Ridge CC access, luxury estates, golf, tennis", "price": "$2M\u2013$8M+", "security": "Gated", "lat": 26.122, "lng": -80.14186, "minPrice": 2000.0, "maxPrice": 8000.0}, {"name": "Harbor Beach", "city": "Fort Lauderdale", "county": "Broward", "type": "Luxury Waterfront", "amenities": "Private surf club, deep-water dockage, wide canals, beach", "price": "$3M\u2013$30M+", "security": "Guard-gated", "lat": 26.12798, "lng": -80.14698, "minPrice": 3000.0, "maxPrice": 30000.0}, {"name": "The Landings", "city": "Fort Lauderdale", "county": "Broward", "type": "Waterfront", "amenities": "Deep-water canals, tennis, lush landscaping, family-friendly", "price": "$1M\u2013$5M+", "security": "Gated", "lat": 26.12533, "lng": -80.1392, "minPrice": 1000.0, "maxPrice": 5000.0}, {"name": "Rio Vista (gated sections)", "city": "Fort Lauderdale", "county": "Broward", "type": "Historic Luxury", "amenities": "Tree-lined streets, Mediterranean to modern architecture, near downtown", "price": "$1M\u2013$10M+", "security": "Gated sections", "lat": 26.11589, "lng": -80.1416, "minPrice": 1000.0, "maxPrice": 10000.0}, {"name": "Sea Ranch Lakes", "city": "Near Fort Lauderdale", "county": "Broward", "type": "Village/Waterfront", "amenities": "Private Beach Club (tennis, pool, clubhouse), own police, Intracoastal & lakefront", "price": "$2M\u2013$15M+", "security": "Own police/guard gate", "lat": 26.14969, "lng": -80.16223, "minPrice": 2000.0, "maxPrice": 15000.0}, {"name": "Towers of Port Royale", "city": "Fort Lauderdale", "county": "Broward", "type": "Condo/Gated", "amenities": "Guard gated, library, gym, BBQ, heated pool, tennis, marina views", "price": "$200K\u2013$500K", "security": "Guard-gated", "lat": 26.11948, "lng": -80.12896, "minPrice": 200.0, "maxPrice": 500.0}, {"name": "Admiral's Cove", "city": "Jupiter", "county": "Palm Beach", "type": "Luxury Golf/Marina", "amenities": "45 holes of golf, dining, spa, waterfront, marina", "price": "$1M\u2013$15M+", "security": "Guard-gated", "lat": 26.93226, "lng": -80.10188, "minPrice": 1000.0, "maxPrice": 15000.0}, {"name": "BallenIsles", "city": "Palm Beach Gardens", "county": "Palm Beach", "type": "Luxury Golf", "amenities": "3 championship golf courses, fitness center, vibrant social scene", "price": "$500K\u2013$5M+", "security": "Guard-gated", "lat": 26.82082, "lng": -80.11388, "minPrice": 500.0, "maxPrice": 5000.0}, {"name": "The Bear's Club", "city": "Jupiter", "county": "Palm Beach", "type": "Ultra-Luxury Golf", "amenities": "Jack Nicklaus golf course, private club, fitness, dining", "price": "$3M\u2013$20M+", "security": "Guard-gated", "lat": 26.93999, "lng": -80.0822, "minPrice": 3000.0, "maxPrice": 20000.0}, {"name": "Club at Ibis", "city": "West Palm Beach", "county": "Palm Beach", "type": "Golf/Nature", "amenities": "3 Nicklaus family golf courses, sports, social calendar, Grassy Waters Preserve, 33 neighborhoods", "price": "$300K\u2013$3M+", "security": "Gated", "lat": 26.71452, "lng": -80.0535, "minPrice": 300.0, "maxPrice": 3000.0}, {"name": "Frenchman's Creek", "city": "Palm Beach Gardens", "county": "Palm Beach", "type": "Exclusive CC", "amenities": "Country club, private beach club, golf, tennis, dining", "price": "$1M\u2013$10M+", "security": "Guard-gated", "lat": 26.81639, "lng": -80.11844, "minPrice": 1000.0, "maxPrice": 10000.0}, {"name": "Harbour Ridge Yacht & CC", "city": "Palm City", "county": "Martin", "type": "Yacht/Golf", "amenities": "Golf, boating, tennis, 2-mile St. Lucie River, 885 acres, member-owned", "price": "$300K\u2013$2M+", "security": "Guard-gated", "lat": 27.16308, "lng": -80.27644, "minPrice": 300.0, "maxPrice": 2000.0}, {"name": "Mirasol", "city": "Palm Beach Gardens", "county": "Palm Beach", "type": "Luxury Golf", "amenities": "2 championship golf courses, country club, fitness, spa, tennis, pool", "price": "$500K\u2013$5M+", "security": "Guard-gated", "lat": 26.83108, "lng": -80.12709, "minPrice": 500.0, "maxPrice": 5000.0}, {"name": "Old Palm Golf Club", "city": "Palm Beach Gardens", "county": "Palm Beach", "type": "Ultra-Luxury", "amenities": "Raymond Floyd golf course, world-class fitness/spa", "price": "$2M\u2013$15M+", "security": "Guard-gated", "lat": 26.82803, "lng": -80.11079, "minPrice": 2000.0, "maxPrice": 15000.0}, {"name": "PGA National Resort", "city": "Palm Beach Gardens", "county": "Palm Beach", "type": "Golf/Resort", "amenities": "5 championship golf courses, spa, fitness, tennis, dining, resort amenities", "price": "$300K\u2013$3M+", "security": "Gated", "lat": 26.82175, "lng": -80.11472, "minPrice": 300.0, "maxPrice": 3000.0}, {"name": "Sailfish Point", "city": "Stuart", "county": "Martin", "type": "Luxury Waterfront", "amenities": "Private marina, Jack Nicklaus golf, beach club, waterfront estates", "price": "$1M\u2013$10M+", "security": "Guard-gated", "lat": 27.20175, "lng": -80.24999, "minPrice": 1000.0, "maxPrice": 10000.0}, {"name": "Astor Creek Golf & CC", "city": "Port St. Lucie", "county": "St. Lucie", "type": "Golf/CC", "amenities": "18-hole golf, pro shop, 15-acre driving range, pickleball, tennis, 15,000 sq ft clubhouse, fitness, pool, dining", "price": "$300K\u2013$800K+", "security": "Gated", "lat": 27.27143, "lng": -80.35707, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Tradition", "city": "Port St. Lucie", "county": "St. Lucie", "type": "Master-Planned", "amenities": "Multiple gated neighborhoods, pools, parks, trails, town center, schools", "price": "$250K\u2013$700K", "security": "Various gated", "lat": 27.27437, "lng": -80.3515, "minPrice": 250.0, "maxPrice": 700.0}, {"name": "The Club at Treasure Coast", "city": "Port St. Lucie", "county": "St. Lucie", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, fitness", "price": "$300K\u2013$600K", "security": "Gated", "lat": 27.28098, "lng": -80.36809, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Belcher Woods", "city": "Largo", "county": "Pinellas", "type": "Affordable Family", "amenities": "Well-maintained, single-family & condos, near beaches/shopping", "price": "$200K\u2013$500K", "security": "Gated", "lat": 27.91745, "lng": -82.78392, "minPrice": 200.0, "maxPrice": 500.0}, {"name": "Cordoba Estates", "city": "Lutz", "county": "Pasco", "type": "Master-Planned", "amenities": "Pool, dog park, playground, picnic area, tennis, 800+ acres", "price": "$700K\u2013$1.2M", "security": "Gated", "lat": 28.15184, "lng": -82.4684, "minPrice": 700.0, "maxPrice": 1200.0}, {"name": "Culbreath Isles", "city": "South Tampa", "county": "Hillsborough", "type": "Ultra-Luxury", "amenities": "Canal-front to Tampa Bay, first gated neighborhood in Tampa", "price": "$3M+", "security": "Guard-gated", "lat": 27.90367, "lng": -82.46326, "minPrice": 3000.0, "maxPrice": 3000.0}, {"name": "Grand Hampton", "city": "New Tampa", "county": "Hillsborough", "type": "Family", "amenities": "Pool, playground, fitness, near schools and shopping", "price": "$500K\u2013$800K", "security": "Gated", "lat": 28.15611, "lng": -82.35192, "minPrice": 500.0, "maxPrice": 800.0}, {"name": "Seminole Woods", "city": "Seminole", "county": "Pinellas", "type": "Affordable Gated", "amenities": "Maintained amenities, near beaches and shopping", "price": "$200K\u2013$500K", "security": "Gated", "lat": 27.84819, "lng": -82.78235, "minPrice": 200.0, "maxPrice": 500.0}, {"name": "Westchase", "city": "Tampa", "county": "Hillsborough", "type": "Master-Planned", "amenities": "Multiple pools, parks, trails, swim & tennis, community events, top schools", "price": "$300K\u2013$1M+", "security": "Gated sections", "lat": 27.95298, "lng": -82.46738, "minPrice": 300.0, "maxPrice": 1000.0}, {"name": "Alaqua", "city": "Longwood", "county": "Seminole", "type": "Ultra-Luxury", "amenities": "Guard-gated, large estates, Markham Woods Corridor, country club access", "price": "$1M\u2013$5M+", "security": "Guard-gated", "lat": 28.70397, "lng": -81.34418, "minPrice": 1000.0, "maxPrice": 5000.0}, {"name": "Alaqua Lakes", "city": "Longwood", "county": "Seminole", "type": "Luxury Golf", "amenities": "Gary Player golf course, country club, member-owned equity", "price": "$1M\u2013$4M+", "security": "Guard-gated", "lat": 28.70652, "lng": -81.33291, "minPrice": 1000.0, "maxPrice": 4000.0}, {"name": "Barclay Place at Heathrow", "city": "Lake Mary", "county": "Seminole", "type": "Condo/Gated", "amenities": "Small well-kept condos, Heathrow area", "price": "$200K\u2013$350K", "security": "Gated", "lat": 28.76212, "lng": -81.32399, "minPrice": 200.0, "maxPrice": 350.0}, {"name": "Berington Club", "city": "Lake Mary area", "county": "Seminole", "type": "Gated", "amenities": "120+ homes, playground, tennis court", "price": "$300K\u2013$500K", "security": "Gated", "lat": 28.76117, "lng": -81.29793, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Brantley Place", "city": "Altamonte Springs", "county": "Seminole", "type": "Gated", "amenities": "57 homes, near shopping, convenient to I-4", "price": "$250K\u2013$400K", "security": "Gated", "lat": 28.6523, "lng": -81.36953, "minPrice": 250.0, "maxPrice": 400.0}, {"name": "Calabria Cove", "city": "Sanford", "county": "Seminole", "type": "Gated", "amenities": "~35 homes, near shopping on Lake Mary Blvd", "price": "$250K\u2013$400K", "security": "Gated", "lat": 28.80147, "lng": -81.27448, "minPrice": 250.0, "maxPrice": 400.0}, {"name": "Capri Cove", "city": "Sanford", "county": "Seminole", "type": "Gated", "amenities": "~35 homes, near SR 46", "price": "$200K\u2013$350K", "security": "Gated", "lat": 28.80825, "lng": -81.26302, "minPrice": 200.0, "maxPrice": 350.0}, {"name": "Cardinal Glen", "city": "Oviedo", "county": "Seminole", "type": "Custom/Gated", "amenities": "40 custom home lots, upscale", "price": "$350K\u2013$500K", "security": "Gated", "lat": 28.66919, "lng": -81.20285, "minPrice": 350.0, "maxPrice": 500.0}, {"name": "Carisbrooke", "city": "Longwood", "county": "Seminole", "type": "Luxury Gated", "amenities": "44 lots, custom homes, Markham Woods", "price": "$650K\u2013$1M+", "security": "Gated", "lat": 28.69596, "lng": -81.332, "minPrice": 650.0, "maxPrice": 1000.0}, {"name": "Chapman Lakes", "city": "Oviedo", "county": "Seminole", "type": "Gated", "amenities": "Pool, community amenities", "price": "$250K\u2013$425K", "security": "Gated", "lat": 28.66635, "lng": -81.20946, "minPrice": 250.0, "maxPrice": 425.0}, {"name": "Coventry at Heathrow", "city": "Lake Mary", "county": "Seminole", "type": "Luxury", "amenities": "Taylor Morrison homes, within Heathrow, upscale", "price": "$500K\u2013$1M+", "security": "Guard-gated", "lat": 28.75862, "lng": -81.3111, "minPrice": 500.0, "maxPrice": 1000.0}, {"name": "DeBary Golf & CC", "city": "DeBary", "county": "Volusia", "type": "Golf/Gated", "amenities": "Golf course, multiple gated neighborhoods (Cinnamon Bay, Lakeside, Fairway Hills, Estates)", "price": "$300K\u2013$800K", "security": "Gated sections", "lat": 28.87946, "lng": -81.33076, "minPrice": 300.0, "maxPrice": 800.0}, {"name": "Eagle's Watch", "city": "Winter Springs", "county": "Seminole", "type": "Gated", "amenities": "110 homes within Tuscawilla development", "price": "$175K\u2013$240K", "security": "Gated", "lat": 28.69153, "lng": -81.26123, "minPrice": 175.0, "maxPrice": 240.0}, {"name": "Egret's Landing", "city": "Lake Mary", "county": "Seminole", "type": "Gated", "amenities": "~220 homes, DR Horton built, pool", "price": "$300K\u2013$500K", "security": "Gated", "lat": 28.76253, "lng": -81.30825, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Ellington Estates", "city": "Oviedo", "county": "Seminole", "type": "Custom/Gated", "amenities": "30 lot custom home community", "price": "$400K\u2013$800K", "security": "Gated", "lat": 28.66674, "lng": -81.20775, "minPrice": 400.0, "maxPrice": 800.0}, {"name": "Golden Oak (Disney)", "city": "Orlando", "county": "Orange", "type": "Ultra-Luxury", "amenities": "Within Walt Disney World, concierge, private park experiences, Disney design", "price": "$2M\u2013$15M+", "security": "Guard-gated", "lat": 28.54441, "lng": -81.36908, "minPrice": 2000.0, "maxPrice": 15000.0}, {"name": "Grand Hampton at MetroWest", "city": "Orlando", "county": "Orange", "type": "Gated", "amenities": "Pool, fitness, near downtown Orlando", "price": "$300K\u2013$500K", "security": "Gated", "lat": 28.53876, "lng": -81.37622, "minPrice": 300.0, "maxPrice": 500.0}, {"name": "Hamptons at MetroWest", "city": "Orlando", "county": "Orange", "type": "Condo/Gated", "amenities": "743 homes, 2 pools, 2 spas, gym, BBQ, walking paths, town square", "price": "$200K\u2013$400K", "security": "Gated", "lat": 28.53469, "lng": -81.3853, "minPrice": 200.0, "maxPrice": 400.0}, {"name": "Heathrow", "city": "Lake Mary", "county": "Seminole", "type": "Master-Planned Luxury", "amenities": "1,900+ homes, multiple neighborhoods, golf, near shopping", "price": "$400K\u2013$2M+", "security": "Guard-gated", "lat": 28.76271, "lng": -81.32918, "minPrice": 400.0, "maxPrice": 2000.0}, {"name": "Heathrow Woods", "city": "Lake Mary", "county": "Seminole", "type": "Luxury Custom", "amenities": "208 lots, 1+ acre min, custom homes, Markham Woods", "price": "$550K\u2013$3M", "security": "Gated", "lat": 28.76233, "lng": -81.30991, "minPrice": 550.0, "maxPrice": 3000.0}, {"name": "Isleworth", "city": "Windermere", "county": "Orange", "type": "Ultra-Luxury", "amenities": "600 acres, Butler Chain of Lakes, Mediterranean clubhouse, fitness, spa, dining, golf, tennis", "price": "$2M\u2013$7M+", "security": "Guard-gated", "lat": 28.4929, "lng": -81.52656, "minPrice": 2000.0, "maxPrice": 7000.0}, {"name": "Keenes Pointe", "city": "Windermere", "county": "Orange", "type": "Luxury Golf", "amenities": "Golden Bear Club (Jack Nicklaus 18-hole), tennis, pools, fitness, lake views", "price": "$1M\u2013$2M+", "security": "Guard-gated", "lat": 28.50264, "lng": -81.51691, "minPrice": 1000.0, "maxPrice": 2000.0}, {"name": "Lake Nona Golf & CC", "city": "Orlando", "county": "Orange", "type": "Luxury Golf", "amenities": "Championship golf, fitness, pool, luxury living, near Medical City", "price": "$1M\u2013$5M+", "security": "Guard-gated", "lat": 28.53084, "lng": -81.39022, "minPrice": 1000.0, "maxPrice": 5000.0}, {"name": "Longwood Club", "city": "Longwood", "county": "Seminole", "type": "Gated", "amenities": "76 lots, Beazer Homes", "price": "$250K\u2013$335K", "security": "Gated", "lat": 28.69631, "lng": -81.33312, "minPrice": 250.0, "maxPrice": 335.0}, {"name": "Magnolia Plantation", "city": "Lake Mary", "county": "Seminole", "type": "Golf/Gated", "amenities": "498 lots, Gary Player golf course, production & custom homes", "price": "$400K\u2013$1.5M", "security": "Gated", "lat": 28.75344, "lng": -81.32336, "minPrice": 400.0, "maxPrice": 1500.0}, {"name": "Provence", "city": "Lake Mary", "county": "Seminole", "type": "Custom/Gated", "amenities": "Custom homes within Heathrow area", "price": "$600K\u2013$1.5M", "security": "Gated", "lat": 28.76659, "lng": -81.31956, "minPrice": 600.0, "maxPrice": 1500.0}, {"name": "Sand Lake Sound", "city": "Dr. Phillips", "county": "Orange", "type": "Gated/Resort", "amenities": "Resort pool, clubhouse, fitness, playground, boat dock, near theme parks", "price": "$400K\u2013$800K", "security": "Gated", "lat": 28.44495, "lng": -81.49612, "minPrice": 400.0, "maxPrice": 800.0}, {"name": "Sandpointe Townhomes", "city": "Orlando", "county": "Orange", "type": "Gated", "amenities": "Pool, fitness, bocce, shuffleboard, tennis, near Disney", "price": "$200K\u2013$400K", "security": "Gated", "lat": 28.53629, "lng": -81.38334, "minPrice": 200.0, "maxPrice": 400.0}, {"name": "Stoneybrook (West)", "city": "Winter Garden", "county": "Orange", "type": "Golf/Gated", "amenities": "Arthur Hills 18-hole golf, clubhouse, fitness, resort pool, lake fishing/boating", "price": "$300K\u2013$700K", "security": "Gated", "lat": 28.56652, "lng": -81.58899, "minPrice": 300.0, "maxPrice": 700.0}, {"name": "Turtle Creek", "city": "Dr. Phillips", "county": "Orange", "type": "Gated", "amenities": "Pool, clubhouse, near Disney Springs and outlets", "price": "$300K\u2013$600K", "security": "Gated", "lat": 28.4504, "lng": -81.50697, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Waterbrooke", "city": "Clermont", "county": "Lake", "type": "Guard-Gated", "amenities": "Resort pool, splash pad, fitness, trails, playground, sports courts", "price": "$300K\u2013$600K", "security": "Guard-gated", "lat": 28.5555, "lng": -81.77544, "minPrice": 300.0, "maxPrice": 600.0}, {"name": "Woodbridge Lakes", "city": "Lake Mary", "county": "Seminole", "type": "Gated", "amenities": "276 homes, pool, community amenities", "price": "$200K\u2013$340K", "security": "Gated", "lat": 28.75233, "lng": -81.31755, "minPrice": 200.0, "maxPrice": 340.0}, {"name": "Villages of Citrus Hills", "city": "Citrus Hills", "county": "Citrus", "type": "All Age", "amenities": "Golf, tennis, fitness, fine dining, swimming, social clubs, rolling hills to 260 ft", "price": "$500K\u2013$2M", "security": "Gated", "lat": 28.86088, "lng": -82.4721, "minPrice": 500.0, "maxPrice": 2000.0}, {"name": "West Hill Estates", "city": "Dade City", "county": "Pasco", "type": "All Age Gated", "amenities": "Large homesites, Lake Jovita Golf & CC membership included, scenic", "price": "$700K+", "security": "Gated", "lat": 28.36283, "lng": -82.20589, "minPrice": 700.0, "maxPrice": 700.0}, {"name": "ETown", "city": "Jacksonville", "county": "Duval", "type": "Master-Planned", "amenities": "Recharge 5-acre amenity (pool, fitness, sports, trails), multiple gated neighborhoods", "price": "$300K\u2013$1M+", "security": "Gated sections", "lat": 30.3354, "lng": -81.6493, "minPrice": 300.0, "maxPrice": 1000.0}, {"name": "Glen Kernan Golf & CC", "city": "Jacksonville", "county": "Duval", "type": "Luxury Golf", "amenities": "18-hole championship golf, 20,000 sq ft clubhouse, tennis, Jr. Olympic saltwater pool, fitness, playground, 350 custom homes (3,200+ sq ft min)", "price": "$500K\u2013$1M+", "security": "24-hr guard gate", "lat": 30.33608, "lng": -81.66393, "minPrice": 500.0, "maxPrice": 1000.0}, {"name": "Jax Golf & Country Club", "city": "Jacksonville", "county": "Duval", "type": "Golf/Gated", "amenities": "1,000+ homes, golf course, clubhouse amenities", "price": "$500K\u2013$1M+", "security": "Gated", "lat": 30.33893, "lng": -81.66643, "minPrice": 500.0, "maxPrice": 1000.0}, {"name": "Middlebourne", "city": "St. Johns", "county": "St. Johns", "type": "Master-Planned", "amenities": "Pool, clubhouse, playground, trails, golf cart access, top schools", "price": "$400K\u2013$700K", "security": "Gated", "lat": 30.10157, "lng": -81.6068, "minPrice": 400.0, "maxPrice": 700.0}, {"name": "Nocatee", "city": "Ponte Vedra", "county": "St. Johns", "type": "Master-Planned", "amenities": "Splash water park, pools, fitness, 5,000+ acres nature preserves, schools, trails, dog park, kayak", "price": "$400K\u2013$2M+", "security": "Various gated", "lat": 30.24287, "lng": -81.38077, "minPrice": 400.0, "maxPrice": 2000.0}, {"name": "Palermo", "city": "Jacksonville", "county": "Duval", "type": "European Luxury", "amenities": "Pool, lanai, loggia, multi-purpose rooms, exercise, European village ambiance", "price": "$500K\u2013$1.5M", "security": "Gated", "lat": 30.33932, "lng": -81.64992, "minPrice": 500.0, "maxPrice": 1500.0}, {"name": "Palm Coast Plantation", "city": "Palm Coast", "county": "Flagler", "type": "Waterfront Gated", "amenities": "Intracoastal Waterway, pool, fitness, walking trails", "price": "$400K\u2013$1.5M", "security": "Gated", "lat": 29.58228, "lng": -81.21746, "minPrice": 400.0, "maxPrice": 1500.0}, {"name": "Plantation Bay", "city": "Ormond Beach", "county": "Volusia", "type": "Golf/Tennis", "amenities": "45 holes golf, 2 clubhouses, 40,500 sq ft Golf Center, 10 tennis courts, 10 pickleball, pool pavilion, trails", "price": "$400K\u2013$4.9M", "security": "Guard-gated", "lat": 29.28401, "lng": -81.04398, "minPrice": 400.0, "maxPrice": 4900.0}, {"name": "Queen's Harbour Yacht & CC", "city": "Jacksonville", "county": "Duval", "type": "Waterfront/Golf", "amenities": "Waterfront, golf, marina, clubhouse, tennis, pool, fitness", "price": "$500K\u2013$2M+", "security": "Guard-gated", "lat": 30.33216, "lng": -81.65668, "minPrice": 500.0, "maxPrice": 2000.0}, {"name": "SilverLeaf", "city": "St. Augustine", "county": "St. Johns", "type": "Master-Planned", "amenities": "Parks, pools, fitness, 3,500+ acres preserved land, resort amenities", "price": "$400K\u2013$1.5M", "security": "Gated", "lat": 29.88676, "lng": -81.32207, "minPrice": 400.0, "maxPrice": 1500.0}, {"name": "Tamaya", "city": "Jacksonville", "county": "Duval", "type": "Luxury Family", "amenities": "10,000 sq ft amenity center, fitness, 2 pools, tennis, event lawn, cabanas, 2-story staffed gatehouse, 2,400 homes", "price": "$600K\u2013$1.6M", "security": "Staffed gatehouse", "lat": 30.33256, "lng": -81.65258, "minPrice": 600.0, "maxPrice": 1600.0}, {"name": "Tidewater", "city": "Jacksonville", "county": "Duval", "type": "Coastal/Family", "amenities": "Nature park, clubhouse, fitness, pool, playground, basketball, plantation-style homes", "price": "$450K\u2013$1.2M", "security": "Gated", "lat": 30.33576, "lng": -81.66474, "minPrice": 450.0, "maxPrice": 1200.0}, {"name": "Burnt Pine", "city": "Sandestin", "county": "Walton", "type": "Ultra-Luxury Golf", "amenities": "Rees Jones golf, private beach, exclusive within Sandestin", "price": "$1M\u2013$5M+", "security": "Guard-gated", "lat": 30.38856, "lng": -86.30693, "minPrice": 1000.0, "maxPrice": 5000.0}, {"name": "Kelly Plantation", "city": "Destin", "county": "Okaloosa", "type": "Golf/Coastal", "amenities": "Fred Couples/Gene Bates golf, clubhouse, tennis, pool, fitness, Choctawhatchee Bay views", "price": "$500K\u2013$3M+", "security": "Guard-gated", "lat": 30.38616, "lng": -86.5012, "minPrice": 500.0, "maxPrice": 3000.0}, {"name": "Sandestin Golf & Beach Resort", "city": "Destin", "county": "Okaloosa", "type": "Resort/Golf", "amenities": "4 golf courses, 15 tennis courts, marina, private beach, fitness, pools, 30+ restaurants, spa", "price": "$300K\u2013$3M+", "security": "Gated resort", "lat": 30.39019, "lng": -86.50062, "minPrice": 300.0, "maxPrice": 3000.0}, {"name": "WaterColor", "city": "Santa Rosa Beach", "county": "Walton", "type": "Luxury Resort", "amenities": "Beachfront, boathouse, pools, tennis, nature trails, camp, restaurants, 499 acres", "price": "$800K\u2013$5M+", "security": "Gated", "lat": 30.37814, "lng": -86.21674, "minPrice": 800.0, "maxPrice": 5000.0}, {"name": "WaterSound", "city": "Panama City Beach", "county": "Bay", "type": "Luxury Coastal", "amenities": "Private beach, pool, fitness, trails, nature preserve", "price": "$1M\u2013$5M+", "security": "Gated", "lat": 30.17018, "lng": -85.80299, "minPrice": 1000.0, "maxPrice": 5000.0}, {"name": "Regatta Bay", "city": "Destin", "county": "Okaloosa", "type": "Golf/Gated", "amenities": "Golf course, clubhouse, pool, fitness, waterfront", "price": "$400K\u2013$1.5M", "security": "Gated", "lat": 30.38742, "lng": -86.50113, "minPrice": 400.0, "maxPrice": 1500.0}];
const electionData = {"12001": {"name": "Alachua", "r24": 38.77, "d24": 59.74, "r20": 35.7, "d20": 62.9}, "12003": {"name": "Baker", "r24": 86.31, "d24": 13.23, "r20": 84.7, "d20": 14.5}, "12005": {"name": "Bay", "r24": 73.12, "d24": 25.77, "r20": 71.1, "d20": 27.5}, "12007": {"name": "Bradford", "r24": 78.38, "d24": 21.15, "r20": 75.8, "d20": 23.2}, "12009": {"name": "Brevard", "r24": 59.91, "d24": 39.07, "r20": 57.6, "d20": 41.2}, "12011": {"name": "Broward", "r24": 41.05, "d24": 58.01, "r20": 34.8, "d20": 64.6}, "12013": {"name": "Calhoun", "r24": 83.49, "d24": 15.88, "r20": 80.8, "d20": 18.5}, "12015": {"name": "Charlotte", "r24": 66.69, "d24": 32.71, "r20": 63.0, "d20": 36.4}, "12017": {"name": "Citrus", "r24": 72.64, "d24": 26.75, "r20": 70.1, "d20": 29.1}, "12019": {"name": "Clay", "r24": 69.17, "d24": 29.91, "r20": 67.9, "d20": 30.8}, "12021": {"name": "Collier", "r24": 66.22, "d24": 33.15, "r20": 62.0, "d20": 37.4}, "12023": {"name": "Columbia", "r24": 74.74, "d24": 24.56, "r20": 72.1, "d20": 27.0}, "12025": {"name": "Miami-Dade", "r24": 55.35, "d24": 43.9, "r20": 46.1, "d20": 53.4}, "12027": {"name": "DeSoto", "r24": 71.17, "d24": 28.23, "r20": 65.7, "d20": 33.6}, "12029": {"name": "Dixie", "r24": 84.93, "d24": 14.52, "r20": 82.8, "d20": 16.7}, "12031": {"name": "Duval", "r24": 50.14, "d24": 48.67, "r20": 47.4, "d20": 51.2}, "12033": {"name": "Escambia", "r24": 59.23, "d24": 39.69, "r20": 56.7, "d20": 41.6}, "12035": {"name": "Flagler", "r24": 63.8, "d24": 35.56, "r20": 60.0, "d20": 39.3}, "12037": {"name": "Franklin", "r24": 71.49, "d24": 27.67, "r20": 68.3, "d20": 31.0}, "12039": {"name": "Gadsden", "r24": 34.27, "d24": 64.95, "r20": 31.4, "d20": 68.0}, "12041": {"name": "Gilchrist", "r24": 83.58, "d24": 15.55, "r20": 81.5, "d20": 17.6}, "12043": {"name": "Glades", "r24": 76.42, "d24": 23.15, "r20": 72.8, "d20": 26.7}, "12045": {"name": "Gulf", "r24": 76.85, "d24": 22.65, "r20": 74.9, "d20": 24.3}, "12047": {"name": "Hamilton", "r24": 69.14, "d24": 30.12, "r20": 65.4, "d20": 33.7}, "12049": {"name": "Hardee", "r24": 77.81, "d24": 21.5, "r20": 72.2, "d20": 27.1}, "12051": {"name": "Hendry", "r24": 68.74, "d24": 30.43, "r20": 61.1, "d20": 38.1}, "12053": {"name": "Hernando", "r24": 68.16, "d24": 31.11, "r20": 64.6, "d20": 34.4}, "12055": {"name": "Highlands", "r24": 70.09, "d24": 29.34, "r20": 66.8, "d20": 32.5}, "12057": {"name": "Hillsborough", "r24": 50.9, "d24": 47.84, "r20": 46.0, "d20": 52.9}, "12059": {"name": "Holmes", "r24": 89.87, "d24": 9.67, "r20": 89.1, "d20": 10.2}, "12061": {"name": "Indian River", "r24": 63.36, "d24": 36.01, "r20": 60.4, "d20": 38.8}, "12063": {"name": "Jackson", "r24": 72.74, "d24": 26.66, "r20": 69.1, "d20": 30.2}, "12065": {"name": "Jefferson", "r24": 58.94, "d24": 40.33, "r20": 53.0, "d20": 46.1}, "12067": {"name": "Lafayette", "r24": 87.75, "d24": 11.74, "r20": 85.5, "d20": 13.9}, "12069": {"name": "Lake", "r24": 61.95, "d24": 37.28, "r20": 59.6, "d20": 39.5}, "12071": {"name": "Lee", "r24": 63.86, "d24": 35.47, "r20": 59.2, "d20": 40.0}, "12073": {"name": "Leon", "r24": 38.52, "d24": 60.28, "r20": 35.3, "d20": 63.5}, "12075": {"name": "Levy", "r24": 74.85, "d24": 24.59, "r20": 72.4, "d20": 26.8}, "12077": {"name": "Liberty", "r24": 83.04, "d24": 16.22, "r20": 79.9, "d20": 19.5}, "12079": {"name": "Madison", "r24": 64.15, "d24": 35.29, "r20": 59.4, "d20": 39.9}, "12081": {"name": "Manatee", "r24": 61.39, "d24": 37.87, "r20": 57.6, "d20": 41.6}, "12083": {"name": "Marion", "r24": 65.47, "d24": 33.83, "r20": 62.5, "d20": 36.6}, "12085": {"name": "Martin", "r24": 65.24, "d24": 34.12, "r20": 62.0, "d20": 37.4}, "12086": {"name": "Miami-Dade", "r24": 55.35, "d24": 43.9, "r20": 46.1, "d20": 53.4}, "12087": {"name": "Monroe", "r24": 58.8, "d24": 40.46, "r20": 53.5, "d20": 45.6}, "12089": {"name": "Nassau", "r24": 73.06, "d24": 26.12, "r20": 72.4, "d20": 26.5}, "12091": {"name": "Okaloosa", "r24": 70.67, "d24": 28.23, "r20": 68.6, "d20": 29.4}, "12093": {"name": "Okeechobee", "r24": 76.69, "d24": 22.86, "r20": 71.9, "d20": 27.5}, "12095": {"name": "Orange", "r24": 42.54, "d24": 56.13, "r20": 37.9, "d20": 61.0}, "12097": {"name": "Osceola", "r24": 50.19, "d24": 48.74, "r20": 42.6, "d20": 56.4}, "12099": {"name": "Palm Beach", "r24": 49.19, "d24": 49.95, "r20": 43.3, "d20": 56.1}, "12101": {"name": "Pasco", "r24": 62.1, "d24": 36.88, "r20": 59.5, "d20": 39.4}, "12103": {"name": "Pinellas", "r24": 52.12, "d24": 46.89, "r20": 49.3, "d20": 49.6}, "12105": {"name": "Polk", "r24": 59.91, "d24": 39.23, "r20": 56.7, "d20": 42.3}, "12107": {"name": "Putnam", "r24": 73.61, "d24": 25.79, "r20": 70.1, "d20": 28.9}, "12109": {"name": "St. Johns", "r24": 65.21, "d24": 33.86, "r20": 62.8, "d20": 36.2}, "12111": {"name": "St. Lucie", "r24": 54.17, "d24": 45.11, "r20": 50.4, "d20": 48.9}, "12113": {"name": "Santa Rosa", "r24": 74.99, "d24": 24.05, "r20": 72.4, "d20": 25.8}, "12115": {"name": "Sarasota", "r24": 58.74, "d24": 40.55, "r20": 54.8, "d20": 44.4}, "12117": {"name": "Seminole", "r24": 51.13, "d24": 47.58, "r20": 48.0, "d20": 50.8}, "12119": {"name": "Sumter", "r24": 68.56, "d24": 30.94, "r20": 67.9, "d20": 31.7}, "12121": {"name": "Suwannee", "r24": 80.22, "d24": 19.26, "r20": 77.9, "d20": 21.3}, "12123": {"name": "Taylor", "r24": 79.56, "d24": 19.92, "r20": 76.5, "d20": 22.7}, "12125": {"name": "Union", "r24": 83.84, "d24": 15.58, "r20": 82.2, "d20": 16.9}, "12127": {"name": "Volusia", "r24": 60.45, "d24": 38.69, "r20": 56.5, "d20": 42.5}, "12129": {"name": "Wakulla", "r24": 71.75, "d24": 27.4, "r20": 70.0, "d20": 29.1}, "12131": {"name": "Walton", "r24": 78.57, "d24": 20.74, "r20": 75.4, "d20": 23.7}, "12133": {"name": "Washington", "r24": 82.41, "d24": 17.01, "r20": 80.1, "d20": 19.0}};
const crimeData    = {"12001": {"name": "Alachua", "violent": 205.1}, "12003": {"name": "Baker", "violent": 215.0}, "12005": {"name": "Bay", "violent": 265.9}, "12007": {"name": "Bradford", "violent": 173.3}, "12009": {"name": "Brevard", "violent": 129.3}, "12011": {"name": "Broward", "violent": 135.1}, "12013": {"name": "Calhoun", "violent": 180.6}, "12015": {"name": "Charlotte", "violent": 60.2}, "12017": {"name": "Citrus", "violent": 76.2}, "12019": {"name": "Clay", "violent": 54.2}, "12021": {"name": "Collier", "violent": 51.9}, "12023": {"name": "Columbia", "violent": 286.9}, "12025": {"name": "Miami-Dade", "violent": 194.2}, "12027": {"name": "DeSoto", "violent": 250.8}, "12029": {"name": "Dixie", "violent": 206.1}, "12031": {"name": "Duval", "violent": 174.9}, "12033": {"name": "Escambia", "violent": 218.9}, "12035": {"name": "Flagler", "violent": 92.1}, "12037": {"name": "Franklin", "violent": 196.8}, "12039": {"name": "Gadsden", "violent": 143.6}, "12041": {"name": "Gilchrist", "violent": 113.4}, "12043": {"name": "Glades", "violent": 180.9}, "12045": {"name": "Gulf", "violent": 114.8}, "12047": {"name": "Hamilton", "violent": 232.3}, "12049": {"name": "Hardee", "violent": 225.9}, "12051": {"name": "Hendry", "violent": 237.4}, "12053": {"name": "Hernando", "violent": 117.9}, "12055": {"name": "Highlands", "violent": 155.6}, "12057": {"name": "Hillsborough", "violent": 168.6}, "12059": {"name": "Holmes", "violent": 170.2}, "12061": {"name": "Indian River", "violent": 135.7}, "12063": {"name": "Jackson", "violent": 107.7}, "12065": {"name": "Jefferson", "violent": 147.3}, "12067": {"name": "Lafayette", "violent": 85.3}, "12069": {"name": "Lake", "violent": 104.4}, "12071": {"name": "Lee", "violent": 83.7}, "12073": {"name": "Leon", "violent": 179.1}, "12075": {"name": "Levy", "violent": 139.1}, "12077": {"name": "Liberty", "violent": 87.4}, "12079": {"name": "Madison", "violent": 234.3}, "12081": {"name": "Manatee", "violent": 120.5}, "12083": {"name": "Marion", "violent": 161.4}, "12085": {"name": "Martin", "violent": 81.4}, "12086": {"name": "Miami-Dade", "violent": 194.2}, "12087": {"name": "Monroe", "violent": 170.3}, "12089": {"name": "Nassau", "violent": 82.3}, "12091": {"name": "Okaloosa", "violent": 108.1}, "12093": {"name": "Okeechobee", "violent": 216.5}, "12095": {"name": "Orange", "violent": 202.8}, "12097": {"name": "Osceola", "violent": 147.2}, "12099": {"name": "Palm Beach", "violent": 107.3}, "12101": {"name": "Pasco", "violent": 107.5}, "12103": {"name": "Pinellas", "violent": 137.3}, "12105": {"name": "Polk", "violent": 169.0}, "12107": {"name": "Putnam", "violent": 231.1}, "12109": {"name": "St. Johns", "violent": 55.6}, "12111": {"name": "St. Lucie", "violent": 133.4}, "12113": {"name": "Santa Rosa", "violent": 90.1}, "12115": {"name": "Sarasota", "violent": 78.2}, "12117": {"name": "Seminole", "violent": 95.6}, "12119": {"name": "Sumter", "violent": 76.1}, "12121": {"name": "Suwannee", "violent": 187.1}, "12123": {"name": "Taylor", "violent": 219.9}, "12125": {"name": "Union", "violent": 109.4}, "12127": {"name": "Volusia", "violent": 179.8}, "12129": {"name": "Wakulla", "violent": 94.5}, "12131": {"name": "Walton", "violent": 117.5}, "12133": {"name": "Washington", "violent": 152.0}};
const taxFips      = {"12001": {"name": "Alachua", "rate": 0.92}, "12005": {"name": "Bay", "rate": 0.59}, "12009": {"name": "Brevard", "rate": 0.7}, "12011": {"name": "Broward", "rate": 0.94}, "12015": {"name": "Charlotte", "rate": 0.84}, "12017": {"name": "Citrus", "rate": 0.61}, "12019": {"name": "Clay", "rate": 0.68}, "12021": {"name": "Collier", "rate": 0.57}, "12023": {"name": "Columbia", "rate": 0.69}, "12031": {"name": "Duval", "rate": 0.77}, "12033": {"name": "Escambia", "rate": 0.57}, "12035": {"name": "Flagler", "rate": 0.77}, "12053": {"name": "Hernando", "rate": 0.65}, "12055": {"name": "Highlands", "rate": 0.66}, "12057": {"name": "Hillsborough", "rate": 0.82}, "12061": {"name": "Indian River", "rate": 0.66}, "12069": {"name": "Lake", "rate": 0.79}, "12071": {"name": "Lee", "rate": 0.78}, "12073": {"name": "Leon", "rate": 0.75}, "12081": {"name": "Manatee", "rate": 0.77}, "12083": {"name": "Marion", "rate": 0.73}, "12085": {"name": "Martin", "rate": 0.7}, "12086": {"name": "Miami-Dade", "rate": 0.76}, "12025": {"name": "Miami-Dade", "rate": 0.76}, "12087": {"name": "Monroe", "rate": 0.52}, "12089": {"name": "Nassau", "rate": 0.68}, "12091": {"name": "Okaloosa", "rate": 0.58}, "12095": {"name": "Orange", "rate": 0.75}, "12097": {"name": "Osceola", "rate": 0.78}, "12099": {"name": "Palm Beach", "rate": 0.83}, "12101": {"name": "Pasco", "rate": 0.75}, "12103": {"name": "Pinellas", "rate": 0.67}, "12105": {"name": "Polk", "rate": 0.74}, "12107": {"name": "Putnam", "rate": 0.84}, "12109": {"name": "St. Johns", "rate": 0.72}, "12111": {"name": "St. Lucie", "rate": 1.0}, "12113": {"name": "Santa Rosa", "rate": 0.59}, "12115": {"name": "Sarasota", "rate": 0.74}, "12117": {"name": "Seminole", "rate": 0.65}, "12119": {"name": "Sumter", "rate": 0.74}, "12127": {"name": "Volusia", "rate": 0.76}, "12131": {"name": "Walton", "rate": 0.53}, "12003": {"name": "Baker", "rate": 0.67}, "12007": {"name": "Bradford", "rate": 0.76}, "12013": {"name": "Calhoun", "rate": 0.59}, "12027": {"name": "DeSoto", "rate": 0.8}, "12029": {"name": "Dixie", "rate": 0.65}, "12037": {"name": "Franklin", "rate": 0.55}, "12039": {"name": "Gadsden", "rate": 0.8}, "12041": {"name": "Gilchrist", "rate": 0.65}, "12043": {"name": "Glades", "rate": 0.65}, "12045": {"name": "Gulf", "rate": 0.58}, "12047": {"name": "Hamilton", "rate": 0.73}, "12049": {"name": "Hardee", "rate": 0.79}, "12051": {"name": "Hendry", "rate": 0.8}, "12059": {"name": "Holmes", "rate": 0.57}, "12063": {"name": "Jackson", "rate": 0.65}, "12065": {"name": "Jefferson", "rate": 0.72}, "12067": {"name": "Lafayette", "rate": 0.6}, "12075": {"name": "Levy", "rate": 0.65}, "12077": {"name": "Liberty", "rate": 0.55}, "12079": {"name": "Madison", "rate": 0.7}, "12093": {"name": "Okeechobee", "rate": 0.8}, "12121": {"name": "Suwannee", "rate": 0.73}, "12123": {"name": "Taylor", "rate": 0.63}, "12125": {"name": "Union", "rate": 0.65}, "12129": {"name": "Wakulla", "rate": 0.75}, "12133": {"name": "Washington", "rate": 0.6}};
const countyTax    = {"Alachua": 0.92, "Bay": 0.59, "Brevard": 0.7, "Broward": 0.94, "Charlotte": 0.84, "Citrus": 0.61, "Clay": 0.68, "Collier": 0.57, "Columbia": 0.69, "Duval": 0.77, "Escambia": 0.57, "Flagler": 0.77, "Hernando": 0.65, "Highlands": 0.66, "Hillsborough": 0.82, "Indian River": 0.66, "Lake": 0.79, "Lee": 0.78, "Leon": 0.75, "Manatee": 0.77, "Marion": 0.73, "Martin": 0.7, "Miami-Dade": 0.76, "Monroe": 0.52, "Nassau": 0.68, "Okaloosa": 0.58, "Orange": 0.75, "Osceola": 0.78, "Palm Beach": 0.83, "Pasco": 0.75, "Pinellas": 0.67, "Polk": 0.74, "Putnam": 0.84, "St. Johns": 0.72, "St. Lucie": 1.0, "Santa Rosa": 0.59, "Sarasota": 0.74, "Seminole": 0.65, "Sumter": 0.74, "Volusia": 0.76, "Walton": 0.53, "Baker": 0.67, "Bradford": 0.76, "Calhoun": 0.59, "DeSoto": 0.8, "Dixie": 0.65, "Franklin": 0.55, "Gadsden": 0.8, "Gilchrist": 0.65, "Glades": 0.65, "Gulf": 0.58, "Hamilton": 0.73, "Hardee": 0.79, "Hendry": 0.8, "Holmes": 0.57, "Jackson": 0.65, "Jefferson": 0.72, "Lafayette": 0.6, "Levy": 0.65, "Liberty": 0.55, "Madison": 0.7, "Okeechobee": 0.8, "Suwannee": 0.73, "Taylor": 0.63, "Union": 0.65, "Wakulla": 0.75, "Washington": 0.6};

// Safe CSS attribute value escape (avoids CSS.escape browser compat issues)
function safeAttr(str) { return str.replace(/"/g, '\\"'); }

// ── Map setup ──────────────────────────────────────────────────────────────
const map = L.map('map', { center: [27.5, -81.8], zoom: 7 });
L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
  attribution: '&copy; OpenStreetMap &copy; CARTO', maxZoom: 19
}).addTo(map);
// Force Leaflet to recalculate dimensions after the flex layout settles
setTimeout(function() { map.invalidateSize(); }, 200);

// ── Side panel ─────────────────────────────────────────────────────────────
var PANEL_W = 234;
var panelEl  = document.getElementById('side-panel');
var toggleEl = document.getElementById('panel-toggle');
// Panel starts open — position toggle to the left of it
toggleEl.style.right = PANEL_W + 'px';
function togglePanel() {
  var isOpen = panelEl.classList.toggle('open');
  toggleEl.style.right = isOpen ? PANEL_W + 'px' : '0';
  // Let Leaflet re-measure after animation
  setTimeout(function() { map.invalidateSize(); }, 320);
}
map.createPane('countyPane');
map.getPane('countyPane').style.zIndex = 350;

// ── Type colors ────────────────────────────────────────────────────────────
const typeColors = {
  'Golf':         { bg: '#68d391', border: '#38a169' },
  'Luxury':       { bg: '#f6ad55', border: '#dd6b20' },
  'Ultra-Luxury': { bg: '#fc8181', border: '#c53030' },
  'Waterfront':   { bg: '#63b3ed', border: '#2b6cb0' },
  'Country Club': { bg: '#b794f4', border: '#6b46c1' },
  'Condo':        { bg: '#76e4f7', border: '#0987a0' },
  'Other':        { bg: '#e94560', border: '#9b2335' },
};
function getTypeCat(t) {
  if (!t) return 'Other';
  const tl = t.toLowerCase();
  if (tl.includes('ultra')) return 'Ultra-Luxury';
  if (tl.includes('golf')) return 'Golf';
  if (tl.includes('luxury')) return 'Luxury';
  if (tl.includes('waterfront')||tl.includes('beach')||tl.includes('marina')||tl.includes('island')) return 'Waterfront';
  if (tl.includes('country club')||(tl.includes('cc')&&tl.length<6)) return 'Country Club';
  if (tl.includes('condo')) return 'Condo';
  return 'Other';
}
function makeIcon(cat) {
  const c = typeColors[cat]||typeColors['Other'];
  return L.divIcon({
    html: '<svg xmlns="http://www.w3.org/2000/svg" width="26" height="34" viewBox="0 0 26 34">'
      +'<path d="M13 0C5.82 0 0 5.82 0 13c0 8.667 13 21 13 21S26 21.667 26 13C26 5.82 20.18 0 13 0z" fill="'+c.border+'"/>'
      +'<path d="M13 2C6.925 2 2 6.925 2 13c0 7.8 11 19 11 19S24 20.8 24 13C24 6.925 19.075 2 13 2z" fill="'+c.bg+'"/>'
      +'<circle cx="13" cy="13" r="5" fill="white" opacity="0.9"/></svg>',
    className:'', iconSize:[26,34], iconAnchor:[13,34], popupAnchor:[0,-34]
  });
}

// ── Cluster group ──────────────────────────────────────────────────────────
const clusterGroup = L.markerClusterGroup({
  maxClusterRadius: 50,
  iconCreateFunction: function(cl) {
    return L.divIcon({
      html:'<div style="background:#e94560;color:#fff;border-radius:50%;width:34px;height:34px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:12px;border:2px solid #fff;box-shadow:0 2px 6px rgba(0,0,0,.4)">'+cl.getChildCount()+'</div>',
      className:'', iconSize:[34,34]
    });
  }
});
map.addLayer(clusterGroup);

// ── Helpers ────────────────────────────────────────────────────────────────
function fmtPrice(k) {
  if (k>=1000){var m=k/1000;return '$'+(m%1===0?m.toFixed(0):m.toFixed(1))+'M';}
  return '$'+k+'K';
}
function crimeTier(rate) {
  if (rate<75)  return {label:'Very Low',  color:'#68d391'};
  if (rate<125) return {label:'Low',        color:'#9ae6b4'};
  if (rate<175) return {label:'Moderate',   color:'#f6e05e'};
  if (rate<225) return {label:'Elevated',   color:'#f6ad55'};
               return {label:'High',        color:'#fc8181'};
}
function taxColor(rate) {
  if (rate < 0.60) return '#2d8e3e';
  if (rate < 0.72) return '#68d391';
  if (rate < 0.82) return '#f6e05e';
  if (rate < 0.92) return '#f6ad55';
               return '#e53e3e';
}

// ── Favorites (localStorage) ───────────────────────────────────────────────
function loadFavs() { try { return JSON.parse(localStorage.getItem('fl_favs')||'[]'); } catch(e){ return []; } }
function saveFavs(arr) { try { localStorage.setItem('fl_favs', JSON.stringify(arr)); } catch(e) {} }
function isFav(name) { return loadFavs().includes(name); }
function toggleFav(name) {
  var favs = loadFavs();
  var idx = favs.indexOf(name);
  if (idx>=0) favs.splice(idx,1); else favs.push(name);
  saveFavs(favs);
  updateFavBtn();
  renderCompareTable();
  // Update all open popups for this community
  document.querySelectorAll('.btn-fav[data-name="'+safeAttr(name)+'"]').forEach(function(el){
    el.textContent = isFav(name) ? 'Saved' : 'Save';
    el.classList.toggle('starred', isFav(name));
  });
}
function updateFavBtn() {
  var n = loadFavs().length;
  var btn = document.getElementById('fav-btn');
  btn.textContent = 'Saved ('+n+')';
  btn.classList.toggle('has-favs', n>0);
}
function clearFavs() { saveFavs([]); updateFavBtn(); renderCompareTable(); }
updateFavBtn();

// ── Popup builder ──────────────────────────────────────────────────────────
function buildPopup(c) {
  var cat = getTypeCat(c.type);
  var tc  = typeColors[cat]||typeColors['Other'];
  var searchUrl = 'https://www.google.com/search?q='+encodeURIComponent(c.name+' '+c.city+' Florida gated community');
  var faved = isFav(c.name);

  // County stats
  var crimeHtml = '', taxHtml = '';
  var cname = c.county;
  // Crime lookup by county name
  var crimeRate = null;
  for (var fips in crimeData) { if (crimeData[fips].name === cname) { crimeRate = crimeData[fips].violent; break; } }
  if (crimeRate !== null) {
    var tier = crimeTier(crimeRate);
    crimeHtml = '<span style="color:'+tier.color+'">'+tier.label+' ('+crimeRate.toFixed(0)+'/100k)</span>';
  }
  var taxRate = countyTax[cname];
  if (taxRate !== undefined) {
    taxHtml = '<span style="color:'+taxColor(taxRate)+'">'+taxRate.toFixed(2)+'%/yr</span>';
  }

  var metaHtml = '';
  if (crimeHtml||taxHtml) {
    metaHtml = '<div class="popup-meta">'
      + (crimeHtml ? '<span>Crime: '+crimeHtml+'</span>' : '')
      + (taxHtml   ? '<span>Tax: '+taxHtml+'</span>' : '')
      + '</div>';
  }

  return '<div class="popup-name">'+c.name+'</div>'
    +'<div class="popup-city">'+c.city+(cname?' &bull; '+cname+' Co.':'')+'</div>'
    +'<span class="popup-type" style="background:'+tc.bg+'22;color:'+tc.bg+';border:1px solid '+tc.bg+'">'+c.type+'</span><br/>'
    +'<div class="popup-price">'+c.price+'</div>'
    +'<div class="popup-amenities">'+c.amenities+'</div>'
    +'<div style="font-size:.68rem;color:#a0aec0;margin-bottom:6px">Security: <span style="color:#63b3ed;font-weight:600">'+c.security+'</span></div>'
    +metaHtml
    +'<div class="popup-actions">'
    +'<a href="'+searchUrl+'" target="_blank" class="popup-btn btn-website">Search Website</a>'
    +'<button class="popup-btn btn-fav'+(faved?' starred':'')+'" data-name="'+c.name.replace(/"/g,'&quot;')+'" onclick="toggleFav(this.dataset.name)">'+(faved?'Saved':'Save')+'</button>'
    +'</div>';
}

// ── Markers ────────────────────────────────────────────────────────────────
const markers = communities.map(function(c) {
  var cat = getTypeCat(c.type);
  var m = L.marker([c.lat,c.lng],{icon:makeIcon(cat)});
  m.bindPopup(function(){ return buildPopup(c); },{maxWidth:290});
  m._community = c;
  m._cat = cat;
  return m;
});

// ── Price slider ───────────────────────────────────────────────────────────
const SLIDER_MIN=140, SLIDER_MAX=10000;
var slider=document.getElementById('slider');
noUiSlider.create(slider,{start:[SLIDER_MIN,SLIDER_MAX],connect:true,range:{min:SLIDER_MIN,max:SLIDER_MAX},step:50,tooltips:false});
var priceDisplay=document.getElementById('price-display');
function updatePriceDisplay(vals){
  var lo=parseFloat(vals[0]),hi=parseFloat(vals[1]);
  priceDisplay.textContent=fmtPrice(lo)+' – '+(hi>=SLIDER_MAX?fmtPrice(hi)+'+':fmtPrice(hi));
}

// ── Type filter ────────────────────────────────────────────────────────────
var allTypes=['Golf','Luxury','Ultra-Luxury','Waterfront','Country Club','Condo','Other'];
var activeTypes={};
allTypes.forEach(function(t){activeTypes[t]=true;});
var typeFilterEl=document.getElementById('type-filter');
allTypes.forEach(function(t){
  var c=typeColors[t]||typeColors['Other'];
  var btn=document.createElement('button');
  btn.className='chip type-btn';
  btn.textContent=t;
  btn.style.borderColor=c.bg; btn.style.color=c.bg; btn.style.background=c.bg+'22';
  btn.addEventListener('click',function(){
    activeTypes[t]=!activeTypes[t];
    btn.style.background=activeTypes[t]?c.bg+'22':'transparent';
    btn.style.color=activeTypes[t]?c.bg:c.bg+'55';
    btn.style.borderColor=activeTypes[t]?c.bg:c.bg+'33';
    applyFilters();
  });
  typeFilterEl.appendChild(btn);
});

// ── Amenity filter ─────────────────────────────────────────────────────────
var amenityKeywords = [
  {label:'Pool',    kw:'pool'},
  {label:'Golf',    kw:'golf'},
  {label:'Tennis',  kw:'tennis'},
  {label:'Fitness', kw:'fitness'},
  {label:'Water',   kw:['waterfront','marina','lake','bay','gulf','beach']},
  {label:'Pickleball', kw:'pickleball'},
  {label:'Clubhouse',  kw:'clubhouse'},
];
var activeAmenities={};
amenityKeywords.forEach(function(a){activeAmenities[a.label]=false;});
var amenityEl=document.getElementById('amenity-filter');
amenityKeywords.forEach(function(a){
  var btn=document.createElement('button');
  btn.className='chip';
  btn.textContent=a.label;
  btn.style.borderColor='#4a5568'; btn.style.color='#718096';
  btn.addEventListener('click',function(){
    activeAmenities[a.label]=!activeAmenities[a.label];
    btn.style.background=activeAmenities[a.label]?'rgba(99,179,237,.25)':'transparent';
    btn.style.color=activeAmenities[a.label]?'#63b3ed':'#718096';
    btn.style.borderColor=activeAmenities[a.label]?'#63b3ed':'#4a5568';
    applyFilters();
  });
  amenityEl.appendChild(btn);
});
function hasAmenity(c, kw) {
  var text=(c.amenities+' '+c.type).toLowerCase();
  if (Array.isArray(kw)) return kw.some(function(k){return text.includes(k);});
  return text.includes(kw);
}

// ── Filter logic ───────────────────────────────────────────────────────────
var currentMin=SLIDER_MIN, currentMax=SLIDER_MAX;
var countBadge=document.getElementById('count-badge');

function applyFilters(){
  var searchVal=(document.getElementById('search-input').value||'').toLowerCase().trim();
  var anyAmenity=amenityKeywords.some(function(a){return activeAmenities[a.label];});
  clusterGroup.clearLayers();
  var toAdd=[];
  markers.forEach(function(m){
    var c=m._community;
    // Type
    if (!activeTypes[m._cat]) return;
    // Price
    var cMin=c.minPrice!==null?c.minPrice:0;
    var cMax=c.maxPrice!==null?c.maxPrice:99999;
    var atMax=currentMax>=SLIDER_MAX;
    if (!atMax&&cMin>currentMax) return;
    if (cMax<currentMin) return;
    // Search
    if (searchVal&&!(c.name.toLowerCase().includes(searchVal)||c.city.toLowerCase().includes(searchVal))) return;
    // Amenities
    if (anyAmenity) {
      var ok=amenityKeywords.every(function(a){
        if (!activeAmenities[a.label]) return true;
        return hasAmenity(c,a.kw);
      });
      if (!ok) return;
    }
    toAdd.push(m);
  });
  clusterGroup.addLayers(toAdd);
  countBadge.textContent=toAdd.length+' communities';
}

slider.noUiSlider.on('update',function(vals){
  currentMin=parseFloat(vals[0]); currentMax=parseFloat(vals[1]);
  updatePriceDisplay(vals); applyFilters();
});
applyFilters();

// ── Compare panel ──────────────────────────────────────────────────────────
var compareOpen=false;
function toggleCompare(){
  compareOpen=!compareOpen;
  document.getElementById('compare-panel').classList.toggle('open',compareOpen);
  if (compareOpen) renderCompareTable();
}
function renderCompareTable(){
  var favs=loadFavs();
  var tbody=document.getElementById('compare-body');
  tbody.innerHTML='';
  var title=document.getElementById('compare-title');
  title.textContent='Saved Communities ('+favs.length+')';
  if (favs.length===0){
    tbody.innerHTML='<tr><td colspan="8" style="text-align:center;color:#718096;padding:20px">No saved communities yet. Click &ldquo;Save&rdquo; on any community popup.</td></tr>';
    return;
  }
  favs.forEach(function(name){
    var c=communities.find(function(x){return x.name===name;});
    if (!c) return;
    var crimeRate=null;
    for (var fips in crimeData){if(crimeData[fips].name===c.county){crimeRate=crimeData[fips].violent;break;}}
    var crimeTierStr='', crimeBadge='';
    if (crimeRate!==null){
      var t=crimeTier(crimeRate);
      crimeBadge='<span class="crime-badge" style="background:'+t.color+'22;color:'+t.color+';border:1px solid '+t.color+'">'+t.label+'<br/>'+crimeRate.toFixed(0)+'/100k</span>';
    }
    var taxRate=countyTax[c.county];
    var taxBadge=taxRate!==undefined?'<span class="tax-badge" style="background:'+taxColor(taxRate)+'22;color:'+taxColor(taxRate)+';border:1px solid '+taxColor(taxRate)+'">'+taxRate.toFixed(2)+'%</span>':'—';
    var tr=document.createElement('tr');
    tr.innerHTML='<td class="td-name">'+c.name+'</td>'
      +'<td>'+c.city+'</td>'
      +'<td>'+c.type+'</td>'
      +'<td style="white-space:nowrap">'+c.price+'</td>'
      +'<td>'+crimeBadge+'</td>'
      +'<td>'+taxBadge+'</td>'
      +'<td style="max-width:200px;font-size:.67rem;color:#a0aec0">'+c.amenities+'</td>'
      +'<td class="td-remove" data-name="'+c.name.replace(/"/g,'&quot;')+'" onclick="toggleFav(this.dataset.name)" title="Remove">&times;</td>';
    tbody.appendChild(tr);
  });
}

// ── County overlay ─────────────────────────────────────────────────────────
var countyLayer=null, topoCache=null, currentOverlay='off';
var overlayLegend=document.getElementById('overlay-legend');
var legTitle=document.getElementById('leg-title');
var legElection=document.getElementById('leg-election');
var legCrime=document.getElementById('leg-crime');
var legTax=document.getElementById('leg-tax');
var loadingOverlay=document.getElementById('loading-overlay');

function electionColor(r,d){
  var m=r-d;
  if (m>45) return 'rgba(130,0,0,.72)';
  if (m>30) return 'rgba(200,30,30,.68)';
  if (m>15) return 'rgba(240,80,80,.62)';
  if (m>5)  return 'rgba(255,160,160,.55)';
  if (m>-5) return 'rgba(210,210,255,.55)';
  if (m>-15) return 'rgba(130,160,255,.62)';
  if (m>-30) return 'rgba(50,80,220,.68)';
             return 'rgba(0,0,160,.72)';
}
function crimeColor(rate){
  if (rate<75)  return 'rgba(45,142,62,.70)';
  if (rate<125) return 'rgba(104,211,145,.65)';
  if (rate<175) return 'rgba(246,224,94,.65)';
  if (rate<225) return 'rgba(246,173,85,.68)';
               return 'rgba(229,62,62,.72)';
}
function taxColorAlpha(rate){
  if (rate<0.60) return 'rgba(45,142,62,.70)';
  if (rate<0.72) return 'rgba(104,211,145,.65)';
  if (rate<0.82) return 'rgba(246,224,94,.65)';
  if (rate<0.92) return 'rgba(246,173,85,.68)';
               return 'rgba(229,62,62,.72)';
}
function getFillColor(fips, overlay){
  var key=String(fips).padStart(5,'0');
  if (overlay==='crime'){
    var cd=crimeData[key]; return cd?crimeColor(cd.violent):'rgba(100,100,100,.25)';
  }
  if (overlay==='tax'){
    var td=taxFips[key]; return td?taxColorAlpha(td.rate):'rgba(100,100,100,.25)';
  }
  var ed=electionData[key]; if (!ed) return 'rgba(100,100,100,.25)';
  return overlay==='2024'?electionColor(ed.r24,ed.d24):electionColor(ed.r20,ed.d20);
}
function buildCountyTip(fips, overlay){
  var key=String(fips).padStart(5,'0');
  if (overlay==='crime'){
    var cd=crimeData[key]; if (!cd) return null;
    var t=crimeTier(cd.violent);
    return '<b>'+cd.name+' County</b><br/>Violent: <b>'+cd.violent.toFixed(1)+'</b>/100k &mdash; <span style="color:'+t.color+'">'+t.label+'</span><br/><em style="color:#718096">FL avg: 145.7</em>';
  }
  if (overlay==='tax'){
    var td=taxFips[key]; if (!td) return null;
    return '<b>'+td.name+' County</b><br/>Eff. tax rate: <b>'+td.rate.toFixed(2)+'%</b><br/><span style="color:'+taxColor(td.rate)+'">'+( td.rate<0.72?'Below avg':td.rate<0.82?'Average':'Above avg')+'</span><br/><em style="color:#718096">FL avg: ~0.74%</em>';
  }
  var ed=electionData[key]; if (!ed) return null;
  var r=overlay==='2024'?ed.r24:ed.r20;
  var d=overlay==='2024'?ed.d24:ed.d20;
  var dem=overlay==='2024'?'Harris':'Biden';
  var winner=r>d?'Trump':dem;
  var wc=r>d?'#ff8080':'#8080ff';
  return '<b>'+ed.name+' County</b>'
    +'<br/><span style="color:'+wc+';font-weight:700">'+winner+' +'+ Math.abs(r-d).toFixed(1)+'%</span>'
    +'<br/><span style="color:#ff9999">R '+r.toFixed(1)+'%</span>'
    +' &nbsp;<span style="color:#99aaff">D '+d.toFixed(1)+'%</span>';
}

function buildCountyLayer(overlay){
  if (countyLayer){map.removeLayer(countyLayer);countyLayer=null;}
  if (overlay==='off'){overlayLegend.classList.remove('visible');return;}
  legElection.style.display='none'; legCrime.style.display='none'; legTax.style.display='none';
  if (overlay==='crime'){legTitle.textContent='Violent Crime (per 100k)'; legCrime.style.display='block';}
  else if (overlay==='tax'){legTitle.textContent='Property Tax Rate'; legTax.style.display='block';}
  else {legTitle.textContent=overlay+' Presidential Vote'; legElection.style.display='block';}

  var features=topojson.feature(topoCache,topoCache.objects.counties).features
    .filter(function(f){return String(f.id).padStart(5,'0').startsWith('12');});

  countyLayer=L.geoJSON(features,{
    pane:'countyPane',
    style:function(f){return{fillColor:getFillColor(f.id,overlay),fillOpacity:1,color:'rgba(255,255,255,.18)',weight:1};},
    onEachFeature:function(f,layer){
      layer.on('mouseover',function(e){
        layer.setStyle({color:'rgba(255,255,255,.7)',weight:2});
        var tip=buildCountyTip(f.id,overlay);
        if (tip) layer.bindTooltip(tip,{sticky:true,className:'county-tip',opacity:.95}).openTooltip(e.latlng);
      });
      layer.on('mouseout',function(){countyLayer.resetStyle(layer);layer.closeTooltip();});
    }
  }).addTo(map);
  overlayLegend.classList.add('visible');
}

function loadTopoAndRender(overlay){
  if (topoCache){buildCountyLayer(overlay);return;}
  loadingOverlay.classList.add('visible');
  fetch('https://cdn.jsdelivr.net/npm/us-atlas@3/counties-10m.json')
    .then(function(r){return r.json();})
    .then(function(topo){topoCache=topo;loadingOverlay.classList.remove('visible');buildCountyLayer(overlay);})
    .catch(function(){loadingOverlay.classList.remove('visible');alert('Could not load county boundaries. Check internet connection.');});
}

document.querySelectorAll('.elec-btn').forEach(function(btn){
  btn.addEventListener('click',function(){
    var ov=btn.getAttribute('data-overlay');
    if (ov===currentOverlay) return;
    currentOverlay=ov;
    document.querySelectorAll('.elec-btn').forEach(function(b){b.classList.remove('active');});
    btn.classList.add('active');
    if (ov==='off'){
      if (countyLayer){map.removeLayer(countyLayer);countyLayer=null;}
      overlayLegend.classList.remove('visible');
    } else { loadTopoAndRender(ov); }
  });
});
</script>
</body>
</html>